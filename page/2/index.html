<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ahhhhhhhhh~~~">
<meta property="og:type" content="website">
<meta property="og:title" content="❄">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="❄">
<meta property="og:description" content="ahhhhhhhhh~~~">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="icSnow">
<meta property="article:tag" content="Crypto,Coder">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>❄</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">❄</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Snow`s Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="icSnow"
      src="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
  <p class="site-author-name" itemprop="name">icSnow</p>
  <div class="site-description" itemprop="description">ahhhhhhhhh~~~</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Cryptanalysis/%E5%B7%AE%E5%88%86%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Cryptanalysis/%E5%B7%AE%E5%88%86%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">Differential Cryptanalysis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-26 16:42:05" itemprop="dateModified" datetime="2022-05-26T16:42:05+08:00">2022-05-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Cryptanalysis/" itemprop="url" rel="index"><span itemprop="name">Cryptanalysis</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><em>有些地方没渲染出来，以后注意</em></p>
<h1 id="Differential-Cryptanalysis"><a href="#Differential-Cryptanalysis" class="headerlink" title="Differential Cryptanalysis"></a>Differential Cryptanalysis</h1><h3 id="DC-to-ToyCipher"><a href="#DC-to-ToyCipher" class="headerlink" title="DC to ToyCipher"></a>DC to ToyCipher</h3><center>
  <img src="https://uploadfiles.nowcoder.com/images/20220417/629760107_1650188144391/B9FB9D37BDF15A699BC071CE49BAEA53" width="30%">
</center>

<h4 id="CIPHER-1"><a href="#CIPHER-1" class="headerlink" title="CIPHER-1"></a>CIPHER-1</h4><p>以一个$toycipher$为例：$CIPHER-1$，其中，$S[·]$ 表示一个公开的 $S-Box$ 置换（可逆)</p>
  <center>
  <img src="https://uploadfiles.nowcoder.com/images/20220417/629760107_1650189319128/D2B5CA33BD970F64A6301FA75AE2EB22" width="80%">
  </center>

<p>在已知明文 $m_{0} \; m_{1}$ ，密文 $c_{0}\;c_{1}$ 的情况下（已知明文攻击），加密过程如下：</p>
<p>(已知：$m_{0} \; m_{1}\; c_{0}\;c_{1} ;$<br>未知：$k_{0}\;k_{1}\;u\;v)$</p>
<center>
  <img src="https://uploadfiles.nowcoder.com/images/20220417/629760107_1650186751354/D2B5CA33BD970F64A6301FA75AE2EB22" width="60%">
  </center>

<p>由于两次加密使用的是相同的密钥 $k_{0}$和 $k_{1}$ ，所以对明文以密码最常用操作( $\bigoplus$ )做差分得到：</p>
  <center>
    <img src="https://uploadfiles.nowcoder.com/images/20220417/629760107_1650186863109/D2B5CA33BD970F64A6301FA75AE2EB22" width="60%">
  </center>

<p>即，明文$m_{0} \; m_{1}$差分 == 中间状态 $u_{0}, u_{1}$ 的差分，消去了密钥 $k_{0}$ 的影响；</p>
<p>所以，跳过 $k_{0}$ 的影响，枚举 $k_{1}$ 的候选值，记 $t$，当$ t$ 满足 </p>
<script type="math/tex; mode=display">
\textcolor{red}{S^{-1}  [ t \bigoplus c_{0}] \bigoplus S^{-1} [ t \bigoplus c_{0}] == m_{0} \bigoplus m_{1}}</script><p>时，记 $1$ 次有效的 $t$ 计数，当 $t$ 计数足够多时，则认为 $t$ 有很大可能就是$k_{1}$ ，只需验证即可。</p>
<p>$ Conclusion\underline{ }\;P_1: $</p>
<ol>
<li>即使中间数据未知，仍然可以通过寻找已知数据的差异来断定中间数据的差异；</li>
<li>差分分析的一种方法(init) ，通过寻找确定的一部分中间状态数据，穷举另一部分未知数据来恢复密钥。</li>
</ol>
<p>下面是一个具体的分析的例子:</p>
  <center>
 <img src="https://uploadfiles.nowcoder.com/images/20220417/629760107_1650189084066/D2B5CA33BD970F64A6301FA75AE2EB22">
  </center>

  <center>
  <img src="https://uploadfiles.nowcoder.com/images/20220417/629760107_1650189139457/D2B5CA33BD970F64A6301FA75AE2EB22">
  </center>


<p>简单解释一下以上例子的过程：（已知明文攻击）</p>
<ol>
<li><p>选择两对明密文，根据上面推出的公式：中间值差分$(u_{0}\bigoplus u_1)==$ 明文差分 $(m_{0} \bigoplus m_{1})$，计算出$u_{0} \bigoplus u_{1}$的值;</p>
</li>
<li><p>计算出$S[·]$的逆$S^{-1}[·]=R[·]$，用来计算核心推导式;</p>
</li>
<li><p>穷举所有的 $k_{1}= t$,根据式：$S^{-1}  [ t \bigoplus c_{0}] \bigoplus S^{-1} [ t \bigoplus c_{0}]$计算出中间值差分;</p>
</li>
<li><p>将3.中的结果与2.中的结果匹配，对可能使等式$S^{-1}  [ t \bigoplus c_{0}] \bigoplus S^{-1} [ t \bigoplus c_{0}] == m_{0} \bigoplus m_{1}$成立的t计数（或存到一个集合中）需要注意使成立的t值可能<font color = purple>不唯一</font>，这就涉及到差分概率，后面再说;</p>
</li>
<li><p>为了找出唯一的$t=k_{1}$，需要更多的明密文对来重复上述1.2.3.4.过程;</p>
</li>
<li><p>将多个明密文对产生的可能$t=k_{1}$结果取交集，直到得到最后的唯一的结果，即可以断定其为正确的$k_{1}$</p>
</li>
</ol>
  <center>
<br>
  <img src="https://uploadfiles.nowcoder.com/images/20220417/629760107_1650203196847/D2B5CA33BD970F64A6301FA75AE2EB22" width="80%">
  <br>
  </center>

<h4 id="CIPHER-2"><a href="#CIPHER-2" class="headerlink" title="CIPHER-2"></a>CIPHER-2</h4><p>下面考虑一个更复杂的例子，假设$Cipher-2$有两个$S$盒及$3$个密钥：</p>
<center>
  <img src="https://uploadfiles.nowcoder.com/images/20220417/629760107_1650203999365/757C75C2BC7E2D8D9493B7FD3FD6BF1F" width="80%">
</center>

<p>明显，在以上例子中，虽然有关系 $m_{0} \bigoplus m_{1}$，但无法通过$S[·]$的逆找到中间值$w$和$v$，因为再往前传递数据的过程中，$S[·]$会消去已部分差分关系（当然，不是完全消去）</p>
<p>那么，就需要更进一步的考虑$S$盒对该差分传递的影响</p>
<p>下面做一个小测试，考虑两个相同$S$盒的输出差分:<br>取i,j分别为进入两个S盒的数据，且i是j的补，即$j=i \bigoplus f$，则有下表$<br></p>
<blockquote>
<p><strong>#小知识：二进制数据$i$的补$==i\bigoplus F_{16} ==i\bigoplus \vec{1}$</strong></p>
</blockquote>
<p>按照$CIPHER-1$的办法无法获取中间值$v$和$w$，因为经过了非线性的$S$盒，$\bigoplus $的差分无法被传递下去；<br>所以选定明文 $i$，和通过明文 $i$ 可以推出的明文 $j$ ，并将其分别进入 $S$ 盒，拿到其输出 $S$ 盒的差分，建立下表：</p>
<center>
  <img src="https://uploadfiles.nowcoder.com/images/20220417/629760107_1650205129825/D2B5CA33BD970F64A6301FA75AE2EB22" width="80%">
</center>


<p>通过上面发现，在第五列，$d$ 出现的频率更高   ，下面给出以上由 $i$ 到 $j$ 到 $S[i] \bigoplus S[j]$ 的推导过程：</p>
<script type="math/tex; mode=display">
i(i.e. message\;or\;plaintext) \rightarrow i \bigoplus F = S[i] \bigoplus S[j]</script><p>所以，我们只需要有一个明文 $i$ 即可；</p>
<p>根据对 $CIPHER-1$ 的攻击可以知道，$m_{0}\bigoplus m_{1} == u_{0} \bigoplus u_{1} == F$,所以有：*当两个异或等于 $ F $ 的值分别进入该 $ S $ 盒，会有$ \frac{10}{16} $的概率得到输出差分 $ d$ ；</p>
<p>同时，通过猜测$ k_{2} $可以得到 $w$ 位置的差分，而 $w$ 位置的差分又等于 $v$ 位置的差分。</p>
<p><strong>所以得到结论：</strong></p>
<p>通过选择两个输入差分为 F 的明文产生密文（并不是选择明文攻击），猜测 $k_{2}$ 从反向在中间进行对比，如果差分数据十分随机，则猜测的 $k_{2}$ 不对，如果猜测 $k_{2}$ 使得在中间 $v_{0}\bigoplus v_{1}$ 为 $d$，则很大可能猜测的 $k_{2}$ 正确。</p>
<p>那么更进一步，对任何一对”选择”的明密文，猜测 $k_{2}$ ，并将所有 $k_{2}$ 的猜测记在$hash$表中，如果 $k_{2}$ 使得中间的差分 $ v_{0}\bigoplus v_{1} = $差分分布表中频率出现最高的数据（如 $Table\;6.1$ 的 $d$），则将该$hash$表中对于的 $k_{2}$ 的位置计数 $+1$.(*逆向推 $k_{2}$ 的过程中，正确的 $k_{2}$ 将会使中间值差分出现的频率远高于其他值出现的频率，如上图 $v_{0} \bigoplus v_{1}=d$ 概率为 $ \frac{10}{16} $,而其他为$ \frac{1}{16} $.</p>
<p>以上的寻找输入差分 $d_{in}$ 及其经过两个 $S-Box$ 之后的输出差分 $d_{out}$ 的值可以建一个差分表 $\textcolor{red}{DDT}$  ,如下：</p>
<p>从下图可以看出，当输入差分为$f$时，输出差分为$d$出现的频率最高次数为10，所以选择差分 $f$ 从 $plaintext$ 注入，获得一条差分概率最大的路径，概率为$\frac{10}{16}$,路径为$f\rightarrow d$. </p>
<p><img src="https://uploadfiles.nowcoder.com/images/20220419/629760107_1650360923811/D2B5CA33BD970F64A6301FA75AE2EB22" alt="img"></p>
<p>对 $CIPHER-2$ 的分析让我们发现了 $S[·]$ 的一些规律，比如：</p>
<ul>
<li>如果两对差分输入位上均不同，如 $0001\;and\;1110$，观察上表的 $1\;and\;e$ ，输出差分在各位也均不同；</li>
<li>在所有位位置不同的十对输入将产生除了第二个最低有效位位置之外的所有不同的输出对；</li>
<li>$and\;so\;on\;and\;so\;forth$</li>
</ul>
<p>那么，如果一对输入输出差分$(\alpha,\beta)$，即输入差分 $\alpha$ 通过 $S[·]$ 可以得到输出差分 $\beta$ ,则称该过程为通过操作 $S[·]$ 的差分特征 $ (differential) \;characteristic\;across\;the\;operation\;S[⋅]$ 记作$\alpha\;\stackrel{S[·]}{\rightarrow}\;\beta$ ,一个特征成立就有与其对应的概率如 $f\;\stackrel{S[·]}{\rightarrow}\;b$ 的概率为$\frac{10}{16}$.</p>
<h3 id="DC-using-Characteristic"><a href="#DC-using-Characteristic" class="headerlink" title="DC using Characteristic"></a>DC using Characteristic</h3><h4 id="CIPHER-3"><a href="#CIPHER-3" class="headerlink" title="CIPHER-3"></a>CIPHER-3</h4><p>有了上面的规律，可以考虑一个更加复杂的$ToyCipher$：$CIPGERTHREE$在$CIPHER-2$的基础上，又多加了一个$S[·]$及一个密钥$k_3$</p>
<center>
<img src="https://uploadfiles.nowcoder.com/images/20220418/629760107_1650291467544/D2B5CA33BD970F64A6301FA75AE2EB22" width="80%">
</center>

<p>有了对$CIPHER-2$的分析方法，对$CIPHER-3$分析就容易理解多了：如果考虑通过一个$S[·]$，则给定差分 $f$ 会得到差分 $d$ 的概率时 $\frac{10}{16}$；那么，考虑差分继续往后传播，到第二个$S[·]$，通过查表 $Table 6.2$ 可以得知，概率最高的是特征 $d\;\stackrel{S[·]}{\rightarrow}\;c$，概率为 $\frac{6}{16}$，也就是说，如果我们希望能够通过”猜密钥”的方式（或者是枚举）得到密钥 $k_3$ ，就需要经过两个 $S[·]$ ，而带来的影响是，差分概率降低（<em>我们选取的是差分概率最高的一条特征路径）。很自然的，我们把通过两个$S[·]$的差分特征概率乘起来 $\frac{10}{16}  </em> \frac{6}{16}=\frac{15}{64}$，也就是说，我们猜出正确的$k_3$的概率是$\frac{15}{64}$,但这也是很大的降低了噪声对我们猜测密钥的影响，因为随机猜测密钥的。</p>
<h4 id="CIPHER-4"><a href="#CIPHER-4" class="headerlink" title="CIPHER-4"></a>CIPHER-4</h4><p>$CIPHER-4$已经十分类似我们现在使用的分组密码（见 $AES$ 算法 $Rijndael$）：使用 $r$ 轮加密，对 $16-bit\;block$ 操作，所有的 $r+1$ 轮的密钥都随机均匀选取，每一轮包含结构 $S[·]\;and\;P[·]$ （都可逆）见下图：</p>
<p><em>其中，每一轮的输入为 $16-bit$ ，被分为 $4 </em> 4-bit$ 的四个半字节放入 $4 <em> S[·]$ 和 $P[·]$ 中运算，也就是说 $S[·]\;and\;P[·]$ 都是在 $\{0,1\}^4\;\rightarrow(0,f)$ 上的置换</em></p>
<h1 id="4-轮的-CIPHER-4-实现了充分的扩散（雪崩），这得益于-P-·-的设计；"><a href="#4-轮的-CIPHER-4-实现了充分的扩散（雪崩），这得益于-P-·-的设计；" class="headerlink" title="4 轮的 $CIPHER-4$ 实现了充分的扩散（雪崩），这得益于$P[·]$的设计；"></a>4 轮的 $CIPHER-4$ 实现了充分的扩散（雪崩），这得益于$P[·]$的设计；</h1><h1 id="除-S-·-外，其余运算对二进制上的加法-bigoplus-均是线性的，-P-·-运算可以用一个线性的矩阵表示；"><a href="#除-S-·-外，其余运算对二进制上的加法-bigoplus-均是线性的，-P-·-运算可以用一个线性的矩阵表示；" class="headerlink" title="除 $S[·]$ 外，其余运算对二进制上的加法 $\bigoplus$ 均是线性的，$P[·]$ 运算可以用一个线性的矩阵表示；"></a>除 $S[·]$ 外，其余运算对二进制上的加法 $\bigoplus$ 均是线性的，$P[·]$ 运算可以用一个线性的矩阵表示；</h1><center>
    <img src="https://uploadfiles.nowcoder.com/images/20220419/629760107_1650357183268/D2B5CA33BD970F64A6301FA75AE2EB22" width = "80%">
</center>
<center>
    <img src="https://uploadfiles.nowcoder.com/images/20220419/629760107_1650357308008/D2B5CA33BD970F64A6301FA75AE2EB22" width="80%">
</center>

<p>下面，考虑对$CIPHER-4$分析，继承对$CIPHER-3$的分析方法，寻找前 $r-1$ 轮的差分特征，猜第 $r$ 轮使用的密钥 $k_r$，由于有 4 个 $S[·]$ 所以将差分特征表示为：</p>
<script type="math/tex; mode=display">
(\alpha_1,\alpha_2,\alpha_3,\alpha_4)\stackrel{S}{\rightarrow}(\beta_1,\beta_2,\beta_3,\beta_4)</script><p>还有一个 $P[·]$ 作用在 $S[·]$ 之后，而 $P[·]$ 不会影响差分值，只会影响其在下一轮出现的位置， $P[·]$的作用是将差分传播到尽可能多的  $S[·]$ 中，将 $P[·]$过程表示为：</p>
<script type="math/tex; mode=display">
(\beta_1,\beta_2,\beta_3,\beta_4)\stackrel{P}{\rightarrow}(\gamma_1,\gamma_2,\gamma_3,\gamma_4)</script><p>所以，$\beta_1||\beta_2||\beta_3||\beta_4$ 就表示输入差分经 $S[·]$ 之后的输出差分，$\gamma_1||\gamma_2||\gamma_3||\gamma_4$ 表示输出差分经 $P[·]$之后该轮最后的输出差分，所以一轮的差分总体表示为：</p>
<script type="math/tex; mode=display">
(\alpha_1,\alpha_2,\alpha_3,\alpha_4)\stackrel{\mathcal{R}}{\rightarrow}(\gamma_1,\gamma_2,\gamma_3,\gamma_4)</script><p>通过表$Table\;6.2$ 可以发现，如果输入 $S[·]$ 的差分为 0，则输出差分也为 0 ，所以对于 $16-bit\;block$，可以以没半个字节为单位，构造只在一位（一个 $S[·]$ 输入差分）为非零值的数据。当然，这在分析上是允许的，但变成了*选择明文攻击，因为明文是我们自己构造的。在考虑$S[·]$的活跃性时，相当于构造只有一个$S[·]$活跃的轮。构造的输入差分例如$(0,0,1,0)$，每一个位置进入一个$S[·]$，那么至少在第一轮只有一个$S[·]$的输出会存在差分。</p>
<p>再考虑到前面对$CIPHER-1,CIPHER-2$分析的时候，得到一个$S[·]$ 存在最大的差分特征 $f\;\stackrel{S[·]}{\rightarrow}\;b$ ，概率为$\frac{10}{16}$，所以将输入差分令为$(0,0,0,f)$，那么对第一轮，就只有第四个$S[·]$ 存在差分，描述经过一轮差分的传递：</p>
<script type="math/tex; mode=display">
(0,0,0,f)\stackrel{S}{\rightarrow}(0,0,0,d)</script><p>但是，一个好的$P[·]$置换，会将差分传递到下一轮尽量多的$S[·]$，比如采用 $MDS$ 矩阵的$P[·]$，见<a target="_blank" rel="noopener" href="https://blog.nowcoder.net/n/0fbe211a2ff74f00bb960825947903ae">$Matrix_Branch\;and\;MDS$</a>。即使不考虑$P[·]$有足够好的扩散性能，其也可以将差分特征扩散，比如：</p>
<script type="math/tex; mode=display">
(0,0,0,d)\stackrel{P}{\rightarrow}(1,1,0,1)</script><p>所以上面整个过程描述下来就是：</p>
<script type="math/tex; mode=display">
(0,0,0,f)\stackrel{\mathcal{R}}{\rightarrow}(1,1,0,1)</script><p>因为这是整个一轮，所以其整个过程的概率就是$\frac{10}{16}$.</p>
<p>继续考虑第二轮，通过表 $Table\;6.2$ 可以看到，$(1,1,0,1)$ 存在差分的三位再经过一次 $S[·]$ 的输出差分特征以概率$(\frac{6}{16})^3$存在（*因为每个输入差分1到输出差分2的特征概率都是$\frac{6}{16}$，所以将其概率相乘才是总体输出差分为$(2,2,0,2)$的概率）且差分特征描述为：</p>
<script type="math/tex; mode=display">
(1,1,0,1)\stackrel{\mathcal{S}}{\rightarrow}(2,2,0,2)</script><p>经过一次 $P[·]$ 置换，以概率 1 获得差分$(0,0,d,0)$：</p>
<center>
    <img src="https://uploadfiles.nowcoder.com/images/20220419/629760107_1650375507202/0F3B05EDC47049CEB882AF3A187D174E" width="80%">
</center>

<script type="math/tex; mode=display">
(2,2,0,2)\stackrel{\mathcal{S}}{\rightarrow}(0,0,d,0)</script><p>所以，两轮的差分传递描述为：</p>
<script type="math/tex; mode=display">
\begin{align}
(0,0,0,f)\stackrel{\mathcal{R_1}}{\rightarrow}(1,1,0,1)\stackrel{\mathcal{R_2}}{\rightarrow}(0,0,d,0)
\end{align}
\tag{inherited\;path}</script><p>计算总概率，第一轮概率是 $\frac{10}{16}$，第二轮概率是$(\frac{6}{16})^3$，乘在一起得到 $\frac{10}{16} * (\frac{6}{16})^3=\frac{135}{4096}$，也就意味着我们在枚举密钥时，已经失去了对于穷举的优势。当然，对于这个例子可能不十分合适去解释，因为其用来 4 个 $S[·]$ ，那就假设每个$S[·]$ 前面使用的都是相同密钥，密钥是 4 位 2 进制，也就共有 $2^4=16$种可能。很显然 $\frac{135}{4096}$ 要小于 $\frac{1}{16}$ ，所以对两轮$CIPHER-4$的差分分析失去了消除噪声的优势。</p>
<p>考虑一下原因，很自然的想到，$P[·]$ 是影响该结构差分传播的一个大问题，在第 2 轮时由于差分特征被 $P[·]$ 扩散开，所有就产生了三条路径，而计算时需要将三条路径的概率相乘，也就造成了经过两轮后差分特征概率变得如此低。同时，在第一轮输入开始就以我们预像的最大差分概率来构造差分，并将其注入明文来构造明文对，这种方法可能并不会给我们带来最佳差分路径（概率最高），因为其在前面 $CIPHER-1,2,3$ 中使用的差分特征仅仅对 $S[·]$ 而这里有 $P[·]$，所有我们应该将 $S[·]\;and\;P[·]$ 一起考虑。给出一个例子：</p>
<script type="math/tex; mode=display">
(0,0,2,0)\stackrel{S}{\rightarrow}(0,0,2,0)\stackrel{P}{\rightarrow}(0,0,2,0)</script><p>可能这是将差分扩散性作为优先级考虑的一种路径，但这条路径的差分特征概率确实比上面一条更高，通过表$Table\;6.2$发现，差分特征概率为$\frac{6}{16}$,为一轮的差分特征概率，同时为每一轮的差分特征概率。所有经过 4 轮之后，得到概率为 $(\frac{6}{16})^4$ 的差分特征路径：</p>
<script type="math/tex; mode=display">
\begin{align}
(0,0,2,0)\stackrel{\mathcal{R_1}}{\rightarrow}(0,0,2,0)\stackrel{\mathcal{R_2}}{\rightarrow}(0,0,2,0)\stackrel{\mathcal{R_3}}{\rightarrow}(0,0,2,0)\stackrel{\mathcal{R_4}}{\rightarrow}
(0,0,2,0)
\end{align}
\tag{better\;path}</script><p>以上过程也可以通过寻找满足要求的明密文对来描述，如果要求选择的明密文对对满足在每一轮差分都为一定值,如上面的 $(0,0,2,0)$ ，则在随机密钥的情况下（其实对于我们举例的密码，密钥并没有影响到差分，但为保证其随机性，还是随机选择密钥，选择 5 个种子密钥，没有经过密钥编排，用作 4 轮，每一轮使用一个 4 位 2 进制作为密钥参与密码运算），统计对数并计算平均值，然后与总可能差分数量 $2^16=65536$ 作比，可以得到与计算特征概率几乎相同的结果：</p>
<center>
    <img src="https://uploadfiles.nowcoder.com/images/20220420/629760107_1650442599859/D2B5CA33BD970F64A6301FA75AE2EB22" width="80%">
</center>

<p>来比较以下，</p>
<ul>
<li>$better\;path$ 的差分特征概率：每一轮的都是 $\frac{6}{16}$ 所有4轮之后概率为 $(\frac{6}{16})^4$</li>
<li>$inherited\;path$ 的差分特征概率：$\frac{10}{16}<em>(\frac{6}{10})^3</em>\frac{6}{10}*\frac{6}{10}$</li>
</ul>
<script type="math/tex; mode=display">
\begin{align}
(0,0,0,f)\stackrel{\mathcal{R_1}}{\rightarrow}(1,1,0,1)\stackrel{\mathcal{R_2}}{\rightarrow}(0,0,d,0)\stackrel{\mathcal{R_3}}{\rightarrow}(0,0,c,0)\stackrel{\mathcal{R_4}}{\rightarrow}(e,0,0,0)
\end{align}
\tag {inherited\;path}</script><p>由上面的对比可以看到，$better\;path$ 拥有更大的差分特征概率。那么考虑以下，在找到 4 轮差分特征之后，是否有相对于穷举的优势来猜第五轮的密钥$k_5$，很明显，$(\frac{6}{16})^4 &lt;\frac{1}{16}$，也就是噪声大于我们猜测的概率。</p>
<p>这是否意味着差分分析的失败？？（假设上面的$better\;path$ 就是最好的差分特征传播路径）在一定轮数之后就失去了其统计上的意义？？可能差分确实在传递到一定论数之后确实会因为特征概率太小而被噪声淹没，但似乎我们漏掉了一些使概率放大的办法…</p>
<h3 id="DC-with-Differential"><a href="#DC-with-Differential" class="headerlink" title="DC with Differential"></a>DC with Differential</h3><h4 id="Different-path-to-same-destination"><a href="#Different-path-to-same-destination" class="headerlink" title="Different path to same destination"></a>Different path to same destination</h4><p>在我们上面的分析中，计算了每一轮的路径、特征及概率，但对现实使用的密码进行差分分析时，往往不会这样做，因为拿到每一轮的结果过于复杂，往往使用一定工具，如 <a target="_blank" rel="noopener" href="https://blog.nowcoder.net/n/fa9ab4fc67614b9388fd8406195cd2e0">MILP</a>，来搜索达到可提供优势的差分路径的最大长度。而该搜索过程也不会考虑中间差分值，仅仅考虑该路径的输入差分和输出差分，中间值都可以为未知，例如对$CIPHER-4$有：</p>
<script type="math/tex; mode=display">
(0,0,2,0)\stackrel{\mathcal{R_1}}{\rightarrow}?\stackrel{\mathcal{R_2}}{\rightarrow}?\stackrel{\mathcal{R_3}}{\rightarrow}?\stackrel{\mathcal{R_4}}{\rightarrow}(0,0,2,0)

\tag{practice\;path}</script><p>假设我们限制特定的输入输出差分，如都为 $(0,0,2,0)$，那么中间值无论是多少，只要能达到这一点就算做 *优势对*，否则算作 *劣势对*。很自然的想到，经过 4 轮且满足条件：输入差分为$(0,0,2,0)$且输出差分为$(0,0,2,0)$ 的优势对远远不止中间值$better\;path$所示的那些，我们将优势对构成的路径记为 $Adv\;paths$：</p>
<script type="math/tex; mode=display">
(0,0,2,0)\stackrel{\mathcal{R_1}}{\rightarrow}(0,0,2,0)\stackrel{\mathcal{R_2}}{\rightarrow}(0,0,2,0)\stackrel{\mathcal{R_3}}{\rightarrow}(0,0,2,0)\stackrel{\mathcal{R_4}}{\rightarrow}(0,0,2,0)\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;
*Adv\;path\;_1*\\

(0,0,2,0)\stackrel{\mathcal{R_1}}{\rightarrow}(0,0,0,2)\stackrel{\mathcal{R_2}}{\rightarrow}(0,0,0,1)\stackrel{\mathcal{R_3}}{\rightarrow}(0,0,1,0)\stackrel{\mathcal{R_4}}{\rightarrow}(0,0,2,0)\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;
*Adv\;path\;_2*\\

(0,0,2,0)\stackrel{\mathcal{R_1}}{\rightarrow}(0,0,0,2)\stackrel{\mathcal{R_2}}{\rightarrow}(0,0,1,0)\stackrel{\mathcal{R_3}}{\rightarrow}(0,0,2,0)\stackrel{\mathcal{R_4}}{\rightarrow}(0,0,2,0)\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;
*Adv\;path\;_3*\\

(0,0,2,0)\stackrel{\mathcal{R_1}}{\rightarrow}(0,0,2,0)\stackrel{\mathcal{R_2}}{\rightarrow}(0,0,0,2)\stackrel{\mathcal{R_3}}{\rightarrow}(0,0,1,0)\stackrel{\mathcal{R_4}}{\rightarrow}(0,0,2,0)\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;
*Adv\;path\;_4*</script><p>可以查表$Table\;6.2$可以验证以上$Adv\;paths$，及查询其特征概率，均为$(\frac{6}{16})^4$ ,所以将其特征概率相加得到 $4*(\frac{6}{16})^4=\frac{81}{1024}$ ，而 $\frac{81}{1024} &gt; \frac{1}{16}$，所以，在不考虑路径中间差分值的时候，差分攻击对分析 4 轮 $CIPHER-4$，来猜测第五轮密钥 $k_5$ 时是有一定优势的。在实践的差分分析中，我们往往也是采用这种办法。</p>
<p>同样的，类似 $ Fig.\;6.7$ 的描述方式如下：明显的，忽略了中间差分值，使优势对的数量提升了，这对应差分特征概率的提升。</p>
<center>
    <img src="https://uploadfiles.nowcoder.com/images/20220420/629760107_1650442831543/D2B5CA33BD970F64A6301FA75AE2EB22" width="80%">
</center>

<h4 id="Filtering"><a href="#Filtering" class="headerlink" title="Filtering"></a>Filtering</h4><p>所谓差分密码分析，即识别发生差异的统计特性异常分布，产生比被我们称作噪声的枚举概率更高的猜测概率，从而使我们在猜测时，正确的数据能够从海量的数据中凸显出来，而非被其淹没。</p>
<p>在前面已经介绍了将差分特征概率尽量提高的办法（当然还会有其他更有效的办法），那现在该把关注点放在猜测密钥上。</p>
<p>回顾下前面整个过程：</p>
<ol>
<li>建$DDT$表并通过密码结果找出最佳差分路径，记录每一轮都满足差分路径的*数据*（明文1：密文1，明文2：密文2 为一对），例子中大概有1296对；</li>
<li>只考虑输入差分和输出差分，而不需要在每一轮都满足差分路径以提高差分特征概率，将同时满足输入差分和输出差分的数据记录下来，例子中大概有 5310 对；</li>
<li>枚举所有密文（全空间）因为寻找的差分路径是在一定概率下成立的，所有需要枚举所有密文，才能利用到差分提供的优势（才能达到使正确密钥凸显出的数据量）</li>
</ol>
<p>按照这个过程，我们将在最后一轮对每个密文，如果密码设计足够好的话会有 $2^{16}=65536$ 个，考虑对的话就是 $A^2_{65536}$，这将是很庞大的数据量，且对每一对密文都需要枚举 $2^{16}$ 个密钥，与构造的区分器进行对比。显然，虽然我们通过忽略中间差分路径取值来提高了特征概率，但在枚举猜密钥的过程中仍然需要很高的复杂度。</p>
<p>所有，需要考虑将密文对筛掉一些，只留下满足条件的密文对，在第四轮之后，得到的差分值为$(0,0,2,0)$，通过查表 $Table\;6.2$ 可得，该差分经过一次 $S[·]$ 得到的值可能为 $(0,0,h,0)$ 其中 $h\in{\{1,2,9,a\}}$，而最后一轮没有 $P[·]$ ，那么对所有密文，我们需要留下的仅仅是满足条件：</p>
<ol>
<li><p>输入差分为$(0,0,2,0)$的明文加密所得；</p>
</li>
<li><p>在 1. 的基础上，将差分的第 0，1，3 半字节位不为全零，且第 2 半字节位不等于 ${\{1,2,9,a\}}$ 的密文对筛掉。</p>
</li>
</ol>
<p>将所以符合上述条件的密文对记录下来，上述例子中大概有 7387 对，也就是说我们仅仅需要对 7387 个密文对，枚举所有可能的最后一轮密钥，这就将数据量降下来很多，同时，找到正确密钥的概率变为 $\frac{5310}{7387} \approx 70\%$  ,使用未经过筛选的密文对猜密钥，得到正确的概率是 $\frac{5310}{56636} \approx 8\%$，可见，筛选给猜密钥提供了很大的优势。书中给出的解释：</p>
<p><center>
    <img src="https://uploadfiles.nowcoder.com/images/20220420/629760107_1650456161985/D2B5CA33BD970F64A6301FA75AE2EB22" width="80%">
</center></p>
<h4 id="Key-Recovery"><a href="#Key-Recovery" class="headerlink" title="Key Recovery"></a>Key Recovery</h4><p>在 4 轮之后，差分传递的特征及其概率如下：</p>
<script type="math/tex; mode=display">
(0,0,2,0)\stackrel{\mathcal{R_1}}{\rightarrow}?\stackrel{\mathcal{R_2}}{\rightarrow}?\stackrel{\mathcal{R_3}}{\rightarrow}?\stackrel{\mathcal{R_4}}{\rightarrow}(0,0,2,0)
\tag{practice\;path}</script><p>概率为 $\frac{5310}{65536} \approx(\frac{6}{16})^4\approx0.08$，而筛选之后剩余的对的概率为 $\frac{7387}{65536} \approx0.11$，筛选出的对中可以用来求出正确密钥的对的比率为 $\frac{5310}{7387}\approx0.7$.那么，给出一个例子，如果我们有总共 $t$ 个对，筛选后留下的对为 $t<em>0.11$ 个，可能满足条件的对为 $t</em>0.08$ 个。比如 $t=500$ ，则会筛选出 $55$ 个满足差分特征的对，其中有 $40$ 个是由正确的最后一轮密钥加密所得，$15$ 个为无用对。为什么会有一部分无用对留下？我们筛选留下的是明文差分且密文差分都满足条件的对，而在密文位置满足差分特征的对往回推并不一定能够得到区分器末尾（例子第四轮后）的差分值。</p>
<p><center>
    <img src="https://uploadfiles.nowcoder.com/images/20220420/629760107_1650463751096/D2B5CA33BD970F64A6301FA75AE2EB22" width="80%">
</center><br>简单陈述这个过程存在的缺陷：</p>
<ol>
<li><p>我们只能通过对比，确切的猜出不为零的第 2 个半字节位，即 4 个 $bits$，记作目标比特 $target\;bits$ ，但其他 3 个半字节位由于没有穷尽所有可能的结果，所有无法确定其值。这并未达到分析的目的，甚至连一轮密钥都没有获取到。需要恢复更多 $bits $，需要重复该过程来恢复全 $bits$ 的密钥。</p>
</li>
<li><p>每次只能恢复一轮的密钥，想要恢复更多轮，可能需要更多次的重复上述过程，或者根据密钥编排算法来推所有密钥。（往往是拿到足够多轮次的密钥之后再根据密钥编排算法推）</p>
</li>
</ol>
<p>*差分分析中，获得了一部分密钥 $bits$ 之后，会大大提高恢复其余更多 $bits$ 的难度。</p>
<script type="math/tex; mode=display">
The\;end</script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Algorithm/%E8%93%84%E6%B0%B4%E6%B1%A0%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Algorithm/%E8%93%84%E6%B0%B4%E6%B1%A0%E7%AE%97%E6%B3%95/" class="post-title-link" itemprop="url">蓄水池算法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-22 12:11:44" itemprop="dateModified" datetime="2022-05-22T12:11:44+08:00">2022-05-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Code-Algo/" itemprop="url" rel="index"><span itemprop="name">Code_Algo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="蓄水池算法"><a href="#蓄水池算法" class="headerlink" title="蓄水池算法"></a>蓄水池算法</h1><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV17i4y1j7wE/?spm_id_from=333.788.recommend_more_video.1">https://www.bilibili.com/video/BV17i4y1j7wE/?spm_id_from=333.788.recommend_more_video.1</a></p>
<p>假设有一个蓄水池，蓄水池里不断加水，问如何在每一时刻都能以相同概率采样到数据？当然还可能有很多别的理解方式，但都要求在数据量变化的情况下使得抽样的概率相等。</p>
<p>具体例子：<a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/random-pick-index/">398. 随机数索引</a></p>
<p>当然，存在很多现有的函数能够实现随机采样，但归其根源，考虑用概率解决：</p>
<h2 id="算法过程"><a href="#算法过程" class="headerlink" title="算法过程"></a>算法过程</h2><p>假设数据序列的规模为 $n$，需要采样的数量的为 $k$。</p>
<p>首先构建一个可容纳 $k$ 个元素的数组，将序列的前 $k$ 个元素放入数组中。</p>
<p>然后从第 $k+1$ 个元素开始，以 $k_n$ 的概率来决定该元素是否被替换到数组中（数组中的元素被替换的概率是相同的）。 当遍历完所有元素之后，数组中剩下的元素即为所需采取的样本。</p>
<h2 id="证明过程"><a href="#证明过程" class="headerlink" title="证明过程"></a>证明过程</h2><p>也可以抽取的样本是 $1$，概率就变成 $\frac{1}{n}$ ，如下：</p>
<p>当只有一个数据时，采样到的概率为 $1$ ；</p>
<p>加入一个数据时，取到它的概率为 $\frac{1}{2}$，那么，取到第一个数据的概率也为  $\frac{1}{2}$；</p>
<p>再加入一个数据，取到它的概率为 $\frac{1}{3}$，取到前两个数据的概率就应该发生变化，为 之前的概率*本次未被选中的概率，即$\frac{1}{2}\times(1-\frac{1}{3})=\frac{1}{3}$；</p>
<p>以此类推…</p>
<p>对于抽样 $k$ 个数据集：</p>
<p>对于第 $i$ 个数$（i≤ki≤k）$。在 $k$ 步之前，被选中的概率为 $1$。当走到第 $k+1$ 步时，被第 $k+1$ 个元素构成的新集合替换的概率 = $k+1$ 个元素中选中前 $k$ 个的概率 <em> 前 $k$ 个中选一个替换的概率，即为 $\frac{k}{k+1}</em>\frac{1}{k}=\frac{1}{k+1}$。则被保留的概率为 $1-\frac{1}{k+1}=\frac{k}{k+1}$。以此类推，则运行到第 $n$ 步时，被保留的概率 = 被选中的概率 * 不被替换的概率，即：</p>
<script type="math/tex; mode=display">
1\times\frac{k}{k+1}\times\frac{k+1}{k+2}\times...\times\frac{n-1}{n}=\frac{k}{n}\\
or\\
\frac{n-1}{n}\times\frac{n-2}{n-1}\times...\times\frac{k}{k+1}\times1=\frac{k}{n}</script><p>这是符合要求的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">i = 0</span><br><span class="line">s = NULL</span><br><span class="line">for line in lines:</span><br><span class="line">	i = i + 1</span><br><span class="line">	r = random.choice(0,1)</span><br><span class="line">	if r &lt; 1/i:</span><br><span class="line">		s = line #替换</span><br></pre></td></tr></table></figure>
<h2 id="关于为什么替换"><a href="#关于为什么替换" class="headerlink" title="关于为什么替换"></a>关于为什么替换</h2><p>替换就是采样，不断地替换或者不替换表示当前是否采样到该数据；</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Algorithm/%E7%BA%A6%E7%91%9F%E5%A4%AB%E7%8E%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Algorithm/%E7%BA%A6%E7%91%9F%E5%A4%AB%E7%8E%AF/" class="post-title-link" itemprop="url">约瑟夫环</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-22 12:12:06" itemprop="dateModified" datetime="2022-05-22T12:12:06+08:00">2022-05-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Code-Algo/" itemprop="url" rel="index"><span itemprop="name">Code_Algo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="约瑟夫环"><a href="#约瑟夫环" class="headerlink" title="约瑟夫环"></a>约瑟夫环</h1><p>参见：</p>
<p> <a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/find-the-winner-of-the-circular-game/">1823. 找出游戏的获胜者</a></p>
<h4 id="剑指-Offer-62-圆圈中最后剩下的数字"><a href="#剑指-Offer-62-圆圈中最后剩下的数字" class="headerlink" title="剑指 Offer 62. 圆圈中最后剩下的数字"></a><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/yuan-quan-zhong-zui-hou-sheng-xia-de-shu-zi-lcof/">剑指 Offer 62. 圆圈中最后剩下的数字</a></h4>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Algorithm/%E7%B4%A0%E6%95%B0%E7%AD%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Algorithm/%E7%B4%A0%E6%95%B0%E7%AD%9B/" class="post-title-link" itemprop="url">素数筛</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-22 12:10:48" itemprop="dateModified" datetime="2022-05-22T12:10:48+08:00">2022-05-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Code-Algo/" itemprop="url" rel="index"><span itemprop="name">Code_Algo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="素数筛"><a href="#素数筛" class="headerlink" title="素数筛"></a>素数筛</h1><h2 id="艾氏筛"><a href="#艾氏筛" class="headerlink" title="艾氏筛"></a>艾氏筛</h2><p>筛出小于 n 的所有素数</p>
<ol>
<li>建立数组记录每个值是否为素数，初始化全是素数；</li>
<li>遍历数组（<strong>遍历到 sqrt(n) 就够了</strong>），将当前值 i 的倍数全部划为合数类；</li>
<li>得到一个划分和素数与合数的数组</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">countPrimes</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        isPrime = [<span class="number">1</span>] * n</span><br><span class="line">        isPrime[<span class="number">0</span>] = isPrime[<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(n ** <span class="number">0.5</span>) + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime[i]:</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i*i,n,i):</span><br><span class="line">                    isPrime[j] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(isPrime)</span><br></pre></td></tr></table></figure>
<p>例子： <a target="_blank" rel="noopener" href="https://leetcode.cn/problems/count-primes/">204. 计数质数</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Algorithm/%E7%9F%A9%E9%98%B5%E5%BF%AB%E9%80%9F%E5%B9%82/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Algorithm/%E7%9F%A9%E9%98%B5%E5%BF%AB%E9%80%9F%E5%B9%82/" class="post-title-link" itemprop="url">矩阵快速幂</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-22 12:08:54" itemprop="dateModified" datetime="2022-05-22T12:08:54+08:00">2022-05-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Code-Algo/" itemprop="url" rel="index"><span itemprop="name">Code_Algo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="矩阵快速幂"><a href="#矩阵快速幂" class="headerlink" title="矩阵快速幂"></a><strong>矩阵快速幂</strong></h1><h2 id="整数快速幂"><a href="#整数快速幂" class="headerlink" title="整数快速幂"></a>整数快速幂</h2><p>解释：计算模幂运算时，可用的规则有：</p>
<script type="math/tex; mode=display">
(a+b)\%m=(a\%m+b\%m)\%m\\
(a*b)\%m=(a\%m*b\%m)\%m</script><p>求幂次时可用将幂次拆分，如 $a^{b}$，</p>
<ul>
<li>b 为奇数时， $a^{b} = a^{b-1}*a^b$</li>
<li>b 为偶数时， $a^{b} = (a^2)^{b-1}$</li>
</ul>
<p>一般是在取模的情况下快速幂，否则会数据过大</p>
<p>例：求 $a^{b}\  \% \ c$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">b = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">c = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="comment"># a^b%c</span></span><br><span class="line">res = <span class="number">1</span>	<span class="comment">#初始为为单位元</span></span><br><span class="line"><span class="keyword">while</span> b&gt;<span class="number">0</span>:</span><br><span class="line">  <span class="keyword">if</span> b&amp;<span class="number">1</span>:</span><br><span class="line">    res = (res * a) % c</span><br><span class="line">  a = a*a</span><br><span class="line">  b &gt;&gt;= <span class="number">1</span> <span class="comment"># == b//2</span></span><br><span class="line">  <span class="comment">#print(a,b,res)</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h2 id="矩阵快速幂-1"><a href="#矩阵快速幂-1" class="headerlink" title="矩阵快速幂"></a>矩阵快速幂</h2><p>矩阵快速幂和整数快速幂原理相同，要求矩阵是方阵，以求斐波那契数列为例：</p>
<script type="math/tex; mode=display">
\left[\begin{array}{ll}
1 & 1 \\
1 & 0
\end{array}\right]\left[\begin{array}{c}
F(n) \\
F(n-1)
\end{array}\right]=\left[\begin{array}{c}
F(n)+F(n-1) \\
F(n)
\end{array}\right]=\left[\begin{array}{c}
F(n+1) \\
F(n)
\end{array}\right]</script><p>因此：</p>
<script type="math/tex; mode=display">
\left[ \begin{matrix} F(n + 1)\\ F(n) \end{matrix} \right] = \left[ \begin{matrix} 1 & 1 \\ 1 & 0 \end{matrix} \right] ^n \left[ \begin{matrix} F(1)\\ F(0) \end{matrix} \right]</script><p>令：</p>
<script type="math/tex; mode=display">
M = \left[ \begin{matrix} 1 & 1 \\ 1 & 0 \end{matrix} \right]</script><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">multiply_matrix</span>(<span class="params">a,b</span>):</span><br><span class="line">            <span class="comment">#a,b = matrix</span></span><br><span class="line">            <span class="comment">#return matrix</span></span><br><span class="line">            c=[[<span class="number">0</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">0</span>]]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                    c[i][j] = (a[i][<span class="number">0</span>]*b[<span class="number">0</span>][j] + a[i][<span class="number">1</span>]*b[<span class="number">1</span>][j]) % <span class="number">1000000007</span></span><br><span class="line">                    <span class="built_in">print</span>(c)</span><br><span class="line">            <span class="keyword">return</span> c</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">pow_matrix</span>(<span class="params">a,n</span>):</span><br><span class="line">            <span class="comment">#初始化为单位阵，不会影响初始运算</span></span><br><span class="line">            res = [[<span class="number">1</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">1</span>]] </span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> n &amp; <span class="number">1</span>:</span><br><span class="line">                    res = multiply_matrix(res,a)</span><br><span class="line">                n &gt;&gt;= <span class="number">1</span>  <span class="comment">#右移一位相当于 ceil(n//2)</span></span><br><span class="line">                a = multiply_matrix(a,a)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">        ans = pow_matrix([[<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">0</span>]],n-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Algorithm/%E5%87%B8%E5%8C%85%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Algorithm/%E5%87%B8%E5%8C%85%E7%AE%97%E6%B3%95/" class="post-title-link" itemprop="url">凸包算法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-22 12:11:16" itemprop="dateModified" datetime="2022-05-22T12:11:16+08:00">2022-05-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Code-Algo/" itemprop="url" rel="index"><span itemprop="name">Code_Algo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="凸包算法"><a href="#凸包算法" class="headerlink" title="凸包算法"></a>凸包算法</h2><p># 待补充：Jarvis，Andrew </p>
<p>感谢<a target="_blank" rel="noopener" href="https://blog.csdn.net/KnightHONG/article/details/101860288">凸包算法详解(Graham扫描法)</a>，由<a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/erect-the-fence/">leetcode 587. 安装栅栏</a> 而来。</p>
<p>理解凸包算法之前需要理解以下几个概念：</p>
<ol>
<li>向量积</li>
<li>Jarvis算法</li>
<li>Graham扫描，及极角排序</li>
<li>Andrew 算法</li>
</ol>
<h3 id="向量积"><a href="#向量积" class="headerlink" title="向量积"></a>向量积</h3><p>在高等数学中，向量的运算包括数量积和向量积：</p>
<p>*数量积，又叫点乘，定义是</p>
<script type="math/tex; mode=display">
\vec{a}=[a_1,a_2,...,a_n]\;and\;\vec{b}=[b_1,b_2,...,b_n]\\
\vec{a} \cdot \vec{b}=\sum_{i\in{(1,n)}}{a_ib_i}</script><p>理解为对应位相乘再相加，如果向量为布尔向量，则乘操作变为 $AND$ 加操作变为 $XOR$ 。</p>
<p>也可以表示为：</p>
<script type="math/tex; mode=display">
\vec{a} \cdot \vec{b}=|\vec{a}||\vec{b}|\cos\theta</script><p>从矩阵的角度理解为 $\vec{a}\cdot\vec{b} = \vec{a}^T*\vec{b}$</p>
<p>例如$\vec{a}=[1,2]^T,\vec{b}=[2,1]^T\;\;\rightarrow\;\;\vec{a}\cdot\vec{b} = 1<em>2+2</em>1=4$ 即点乘得到的是一个数</p>
<p><strong>*向量积</strong>，又叫叉乘，定义为（二维表示）</p>
<script type="math/tex; mode=display">
{\displaystyle \mathbf {\vec{a}} \times \mathbf {\vec{b}} =\|\mathbf {\vec{a}} \|*\|\mathbf {\vec{b}} \|\sin(\theta )\ \mathbf {n} }</script><p>$|\mathbf {a} |\;and\;|\mathbf {b} |$表示向量的模长，$\sin(\theta )$ 是两个向量在其所定义的平面上的夹角，$n$ 为 $\mathbf {\vec{a}} \;and\; \mathbf {\vec{b}}$ 所构成平面上的单位向量，$n$ 的方向根据右手定则判断（从 $\vec{a}$ 到 $\vec{b}$ 弯转四指，大拇指所指方向即为叉乘所得向量方向）所有向量积得到的是一个垂直于由 $\mathbf {\vec{a}} \;and\; \mathbf {\vec{b}}$ 所构成平面的向量，与 $\mathbf {\vec{a}} \;and\; \mathbf {\vec{b}}$ 所构成平面的法向量平行，<strong>如果与法向量同向，则结果取正，否则结果取负</strong>。也可以理解为与法向量反向时，由 $\mathbf {\vec{a}} \times \mathbf {\vec{b}}$ 变成了 $\mathbf {\vec{b}} \times \mathbf {\vec{a}}$ ，所以 $\mathbf {\vec{a}} \times \mathbf {\vec{b}} = -\mathbf {\vec{b}} \times \mathbf {\vec{a}}$ 或者也可表示为取模的形式，得到一个数字而非向量：</p>
<script type="math/tex; mode=display">
{\displaystyle |\mathbf {\vec{a}} \times \mathbf {\vec{b}}| =\|\mathbf {\vec{a}} \|*\|\mathbf {\vec{b}} \|\sin(\theta )}=(a_1*b_2)-(a_2*b_1)</script><p><img src="https://img-blog.csdnimg.cn/20191002101207446.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0tuaWdodEhPTkc=,size_16,color_FFFFFF,t_70" alt="img"></p>
<h3 id="Graham"><a href="#Graham" class="headerlink" title="Graham"></a>Graham</h3><h4 id="极角排序"><a href="#极角排序" class="headerlink" title="极角排序"></a>极角排序</h4><p>我们知道，二维平面上一个向量可以由一个点来表示，如：</p>
<center>
    <img src="https://img-blog.csdnimg.cn/20191001210234595.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0tuaWdodEhPTkc=,size_8,color_FFFFFF,t_70" alt="img" style="zoom:50%;" />
</center>

<p>其中用点表示为 $p1,p2,p3…$ 用向量表示为 $\mathop{p0p1}\limits ^{\rightarrow},\vec{p0p2}…$ （注意这里把 $p0$ 看作原点）</p>
<p>要将以上的各个向量排序，当然不能仅依赖其坐标，那么很自然的考虑到其与坐标轴的夹角，这里以 x 轴正半轴为基准轴，将向量按照与其夹角由小到大排序，那么顺序就是 $\mathop{p0p1}\limits ^{\rightarrow},\vec{p0p2}…\vec{p0p8}$  </p>
<p>做好极角排序的准备工作之后，就可以开始开始凸包算法的<strong>Graham扫描</strong>了。</p>
<h4 id="Graham扫描"><a href="#Graham扫描" class="headerlink" title="Graham扫描"></a>Graham扫描</h4><p>所谓 Graham 扫描，即寻找最外层能够将所有点包含住的一条封闭线，例如：</p>
<center>
    <img src="https://img-blog.csdnimg.cn/20191001212355831.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0tuaWdodEhPTkc=,size_16,color_FFFFFF,t_70" width="60%">
</center>

<p>开始扫描，是将原点 $p0$ 与排序后的第一个顶点  $p1$ 相连得到向量 $\vec{p0p1}$，然后再将  $p1$ 与排序得到的下一个顶点相连，得到 $\vec{p1p2}$，此时需要进行一次判断：</p>
<ul>
<li><p>新加入的点和其与前一个点构成的向量是否为向左偏转（相对于前一条向量）如果是，则该点可能是构成凸包的最外层顶点；</p>
</li>
<li><p>否则，即新加入的点和其与前一个点构成的向量向右偏转（相对于前一条向量），则前面加入的点可能由于新加入了该点而不在外层顶点，换成新加入的点为构成凸包的最外层顶点。</p>
</li>
</ul>
<p>以上图举例：</p>
<p>加入 $p0p1$ 为第一条向量（$p1$ 纳入最外层顶点集），加入 $p1p2$ 为第二条向量（$p2$ 纳入最外层顶点集），此时根据图形判断，相对于第一条向量为向左偏转，加入 $p2p3$ 为第三条向量，判断 $p2p3$ 相对于 $p1p2$ 为向右偏转，则删除点 $p2$ 而将 $p3$ 纳入最外层顶点集…以此类推</p>
<p>那么如何用数学语言判断向量是向哪个方向偏转呢？——向量积，如下图，顶点记 $a=(0,0)$ ，两个向量顶点 $b=(2,3)\;and\;c=(1,5)\;or\;(5,3)$ ：</p>
<p>左图 $\vec{ab(=(2,3))}\times\vec{ac(=(1,5))}=2<em>5-3</em>1=7&gt;0$ ，即向左偏；</p>
<p>右图 $\vec{ab(=(2,3))}\times\vec{ac(=(5,3))}=2<em>3-3</em>5=-9&lt;0$，即向右偏；</p>
<center>
    <img src="https://uploadfiles.nowcoder.com/images/20220423/629760107_1650711275955/6FB53C51539B47559CF0D122A832CF63" width="50%"><img src="https://uploadfiles.nowcoder.com/images/20220423/629760107_1650711275950/FE88E01440218FA643954E80A16BEDBB" width="50%">
</center>


<p>很明显，通过上面对向量积的描述可以推断出当绿色向量相对于蓝色向量向左偏转时叉乘结果为正，向右则为负。</p>
<p>经过对所有顶点的依照条件：</p>
<ol>
<li>将各个坐标依极角排序</li>
<li>新加入点构成的向量较前一条向量向左偏转（叉乘为正）</li>
<li>将满足条件的点留在凸包顶点集，不满足的剔除</li>
</ol>
<p>就得到了一系列顶点的凸包，此即为使用Graham扫描的凸包算法的基本思想。</p>
<p>C语言代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Jarvis"><a href="#Jarvis" class="headerlink" title="Jarvis"></a>Jarvis</h3><h3 id="Andrew"><a href="#Andrew" class="headerlink" title="Andrew"></a>Andrew</h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/25/Algorithm/Brian-Kernighan-Algorithm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://ossimg.yzitc.com/2022/05/24/f573a763bec76.png">
      <meta itemprop="name" content="icSnow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="❄">
      <meta itemprop="description" content="ahhhhhhhhh~~~">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ❄">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/25/Algorithm/Brian-Kernighan-Algorithm/" class="post-title-link" itemprop="url">Brian Kernighan Algorithm</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-25 19:23:36" itemprop="dateCreated datePublished" datetime="2022-05-25T19:23:36+08:00">2022-05-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-23 17:41:10" itemprop="dateModified" datetime="2022-05-23T17:41:10+08:00">2022-05-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Code-Algo/" itemprop="url" rel="index"><span itemprop="name">Code_Algo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Brian-Kernighan-Algorithm"><a href="#Brian-Kernighan-Algorithm" class="headerlink" title="Brian Kernighan Algorithm"></a>Brian Kernighan Algorithm</h1><h2 id="principle"><a href="#principle" class="headerlink" title="principle"></a>principle</h2><p>通过一定的位运算取到二进制数据的相应位</p>
<ol>
<li><p>$n\&amp;(n-1)$ 将数据二进制最右的 1 变为 0 </p>
<p>例如：$n = 11_{(10)} = 1011_{(2)}, n\&amp;(n-1) = 1011 \&amp; 1010 = 1010_{(2)} = 10_{(10)}$</p>
</li>
<li><p>$n\&amp;(~n+1)$ 提取数据二进制最后一个 1 到结尾的数据</p>
<p>例如：$n = 14_{(10)} = 1110_{(2)}, n\&amp;(~n+1) = 1110 \&amp; 0001 + 00001 = 1110 \&amp; 0010 = 0010_{(2)} = 2_{(10)}$</p>
</li>
</ol>
<p>可以测试一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n = random.randint(<span class="number">0</span>,<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(n,<span class="built_in">bin</span>(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n&amp;(n−1):&#x27;</span>,n&amp;(n-<span class="number">1</span>),<span class="built_in">bin</span>(n&amp;(n-<span class="number">1</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n&amp;(~n+1):&#x27;</span>,n&amp;(~n+<span class="number">1</span>),<span class="built_in">bin</span>(n&amp;(~n+<span class="number">1</span>)))</span><br></pre></td></tr></table></figure>
<h2 id="example："><a href="#example：" class="headerlink" title="example："></a>example：</h2><p><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/number-of-1-bits/">191. 位1的个数</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">icSnow</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":100,"height":200},"mobile":{"show":true},"log":false});</script></body>
</html>
